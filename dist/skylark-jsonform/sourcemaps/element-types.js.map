{"version":3,"sources":["element-types.js"],"names":["define","langx","$","jsonform","util","fileDisplayTemplate","inputFieldTemplate","type","template","fieldtemplate","inputfield","elementTypes","none","root","text","password","date","datetime","datetime-local","email","month","number","search","tel","time","url","week","range","onInput","evt","elt","valueIndicator","document","querySelector","id","innerText","target","value","onBeforeRender","data","node","min","max","step","indicator","schemaElement","formElement","minimum","exclusiveMinimum","maximum","exclusiveMaximum","color","onInsert","el","find","escapeSelector","spectrum","preferredFormat","showInput","textarea","wysihtml5","setup","html","link","font-styles","image","events","load","this","textareaElement","removeAttr","window","jsonform_wysihtml5_setup","itv","setInterval","clearInterval","ace","editor","edit","get","idSelector","getSession","setNewLineMode","renderer","setShowPrintMargin","setTheme","aceTheme","aceMode","setMode","setTabSize","setValue","lazyChanged","debounce","val","getValue","change","on","trigger","jsonform_ace_setup","checkbox","getElement","parent","file","file-hosted-public","ownerTree","_transloadit_generic_public_index","transloaditname","_transloadit_generic_elts","onChange","_transloadit_bound","formElt","domRoot","transloadit","autoSubmit","wait","onSuccess","assembly","results","values","flatten","each","result","field","input","nonEmptyKeys","filter","keys","meta","key","isSet","pick","JSON","stringify","unbind","defer","submit","onError","console","log","remove","preventDefault","onSubmit","file-transloadit","replace","select","imageselect","nbRows","maxColumns","imageSelectorColumns","buttonTitle","imageSelectorTitle","prefix","imagePrefix","suffix","imageSuffix","width","imageWidth","height","imageHeight","buttonClass","imageButtonClass","options","length","Math","ceil","columns","stopPropagation","nodeName","toLowerCase","attr","indexOf","substring","addClass","match","removeClass","iconselect","radios","radiobuttons","activeClass","checkboxes","choices","choiceshtml","items","choice","idx","fieldTemplateSettings","name","contains","title","hasOwnProperty","titleMap","array","childTemplate","inner","enableDrag","sortable","$nodeid","boundaries","getArrayBoundaries","click","children","maxItems","insertArrayItem","minItems","curItems","i","deleteArrayItem","draggable","bind","event","ui","fromIdx","toIdx","incr","parentEl","switchValuesWith","render","fromEl","toEl","detach","prepend","after","moveNodeTo","item","index","tabarray","tabs","child","legend","escape","escapeHTML","updateTabs","selIdx","activateFirstTab","undefined","parseInt","eq","Number","containment","tolerance","newIdx","tabEl","help","msg","fieldset","hide","advancedfieldset","authfieldset","button","actions","hidden","parentID","tab_list","title_escaped","e","tab_id","tab","selectfieldset","map","option","childPos","Object","extend","active","activeChild","hasNonDefaultValue","disabled","first","$option","optionfieldset","section","questions","show","question","questionNode","parentNode","nextAll","prop","next","qid","href","open","location","setTimeout"],"mappings":"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","file":"../element-types.js","sourcesContent":["define([\r\n  \"skylark-langx\",\r\n  \"skylark-jquery\",\r\n  \"./jsonform\",\r\n  \"./util\"\r\n],function(langx,$,jsonform,util){\r\n  //245-1516\r\n  var fileDisplayTemplate = '<div class=\"_jsonform-preview\">' +\r\n    '<% if (value.type==\"image\") { %>' +\r\n    '<img class=\"jsonform-preview\" id=\"jsonformpreview-<%= id %>\" src=\"<%= value.url %>\" />' +\r\n    '<% } else { %>' +\r\n    '<a href=\"<%= value.url %>\"><%= value.name %></a> (<%= Math.ceil(value.size/1024) %>kB)' +\r\n    '<% } %>' +\r\n    '</div>' +\r\n    '<a href=\"#\" class=\"btn btn-default _jsonform-delete\"><i class=\"glyphicon glyphicon-remove\" title=\"Remove\"></i></a> ';\r\n\r\n  var inputFieldTemplate = function (type) {\r\n    return {\r\n      'template': '<input type=\"' + type + '\" ' +\r\n        'class=\\'form-control<%= (fieldHtmlClass ? \" \" + fieldHtmlClass : \"\") %>\\'' +\r\n        'name=\"<%= node.name %>\" value=\"<%= escape(value) %>\" id=\"<%= id %>\"' +\r\n        ' aria-label=\"<%= node.title ? escape(node.title) : node.name %>\"' +\r\n        '<%= (node.disabled? \" disabled\" : \"\")%>' +\r\n        '<%= (node.readOnly ? \" readonly=\\'readonly\\'\" : \"\") %>' +\r\n        '<%= (node.schemaElement && (node.schemaElement.step > 0 || node.schemaElement.step == \"any\") ? \" step=\\'\" + node.schemaElement.step + \"\\'\" : \"\") %>' +\r\n        '<%= (node.schemaElement && node.schemaElement.minLength ? \" minlength=\\'\" + node.schemaElement.minLength + \"\\'\" : \"\") %>' +\r\n        '<%= (node.schemaElement && node.schemaElement.maxLength ? \" maxlength=\\'\" + node.schemaElement.maxLength + \"\\'\" : \"\") %>' +\r\n        '<%= (node.schemaElement && node.schemaElement.required && (node.schemaElement.type !== \"boolean\") ? \" required=\\'required\\'\" : \"\") %>' +\r\n        '<%= (node.placeholder? \" placeholder=\" + \\'\"\\' + escape(node.placeholder) + \\'\"\\' : \"\")%>' +\r\n        ' />',\r\n      'fieldtemplate': true,\r\n      'inputfield': true\r\n    }\r\n  };\r\n\r\n  jsonform.elementTypes = {\r\n    'none': {\r\n      'template': ''\r\n    },\r\n    'root': {\r\n      'template': '<div><%= children %></div>'\r\n    },\r\n    'text': inputFieldTemplate('text'),\r\n    'password': inputFieldTemplate('password'),\r\n    'date': inputFieldTemplate('date'),\r\n    'datetime': inputFieldTemplate('datetime'),\r\n    'datetime-local': inputFieldTemplate('datetime-local'),\r\n    'email': inputFieldTemplate('email'),\r\n    'month': inputFieldTemplate('month'),\r\n    'number': inputFieldTemplate('number'),\r\n    'search': inputFieldTemplate('search'),\r\n    'tel': inputFieldTemplate('tel'),\r\n    'time': inputFieldTemplate('time'),\r\n    'url': inputFieldTemplate('url'),\r\n    'week': inputFieldTemplate('week'),\r\n    'range': {\r\n      'template': '<div class=\"range\"><input type=\"range\" ' +\r\n        '<%= (fieldHtmlClass ? \"class=\\'\" + fieldHtmlClass + \"\\' \" : \"\") %>' +\r\n        'name=\"<%= node.name %>\" value=\"<%= escape(value) %>\" id=\"<%= id %>\"' +\r\n        ' aria-label=\"<%= node.title ? escape(node.title) : node.name %>\"' +\r\n        '<%= (node.disabled? \" disabled\" : \"\")%>' +\r\n        ' min=<%= range.min %>' +\r\n        ' max=<%= range.max %>' +\r\n        ' step=<%= range.step %>' +\r\n        '<%= (node.schemaElement && node.schemaElement.required ? \" required=\\'required\\'\" : \"\") %>' +\r\n        ' /><% if (range.indicator) { %><span class=\"range-value\" rel=\"<%= id %>\"><%= escape(value) %></span><% } %></div>',\r\n      'fieldtemplate': true,\r\n      'inputfield': true,\r\n      'onInput': function(evt, elt) {\r\n        const valueIndicator = document.querySelector('span.range-value[rel=\"' + elt.id + '\"]');\r\n        if (valueIndicator) {\r\n          valueIndicator.innerText = evt.target.value;\r\n        }\r\n      },\r\n      'onBeforeRender': function (data, node) {\r\n        data.range = {\r\n          min: 1,\r\n          max: 100,\r\n          step: 1,\r\n          indicator: false\r\n        };\r\n        if (!node || !node.schemaElement) return;\r\n        if (node.formElement && node.formElement.step) {\r\n          data.range.step = node.formElement.step;\r\n        }\r\n        if (node.formElement && node.formElement.indicator) {\r\n          data.range.indicator = node.formElement.indicator;\r\n        }\r\n        if (typeof node.schemaElement.minimum !== 'undefined') {\r\n          if (node.schemaElement.exclusiveMinimum) {\r\n            data.range.min = node.schemaElement.minimum + data.range.step;\r\n          }\r\n          else {\r\n            data.range.min = node.schemaElement.minimum;\r\n          }\r\n        }\r\n        if (typeof node.schemaElement.maximum !== 'undefined') {\r\n          if (node.schemaElement.exclusiveMaximum) {\r\n            data.range.max = node.schemaElement.maximum - data.range.step;\r\n          }\r\n          else {\r\n            data.range.max = node.schemaElement.maximum;\r\n          }\r\n        }\r\n      }\r\n    },\r\n    'color':{\r\n      'template':'<input type=\"text\" ' +\r\n        '<%= (fieldHtmlClass ? \"class=\\'\" + fieldHtmlClass + \"\\' \" : \"\") %>' +\r\n        'name=\"<%= node.name %>\" value=\"<%= escape(value) %>\" id=\"<%= id %>\"' +\r\n        ' aria-label=\"<%= node.title ? escape(node.title) : node.name %>\"' +\r\n        '<%= (node.disabled? \" disabled\" : \"\")%>' +\r\n        '<%= (node.schemaElement && node.schemaElement.required ? \" required=\\'required\\'\" : \"\") %>' +\r\n        ' />',\r\n      'fieldtemplate': true,\r\n      'inputfield': true,\r\n      'onInsert': function(evt, node) {\r\n        $(node.el).find('#' + util.escapeSelector(node.id)).spectrum({\r\n          preferredFormat: \"hex\",\r\n          showInput: true\r\n        });\r\n      }\r\n    },\r\n    'textarea':{\r\n      'template':'<textarea id=\"<%= id %>\" name=\"<%= node.name %>\" ' +\r\n        '<%= (fieldHtmlClass ? \"class=\\'\" + fieldHtmlClass + \"\\' \" : \"\") %>' +\r\n        'style=\"height:<%= elt.height || \"150px\" %>;width:<%= elt.width || \"100%\" %>;\"' +\r\n        ' aria-label=\"<%= node.title ? escape(node.title) : node.name %>\"' +\r\n        '<%= (node.disabled? \" disabled\" : \"\")%>' +\r\n        '<%= (node.readOnly ? \" readonly=\\'readonly\\'\" : \"\") %>' +\r\n        '<%= (node.schemaElement && node.schemaElement.minLength ? \" minlength=\\'\" + node.schemaElement.minLength + \"\\'\" : \"\") %>' +\r\n        '<%= (node.schemaElement && node.schemaElement.maxLength ? \" maxlength=\\'\" + node.schemaElement.maxLength + \"\\'\" : \"\") %>' +\r\n        '<%= (node.schemaElement && node.schemaElement.required ? \" required=\\'required\\'\" : \"\") %>' +\r\n        '<%= (node.placeholder? \" placeholder=\" + \\'\"\\' + escape(node.placeholder) + \\'\"\\' : \"\")%>' +\r\n        '><%= value %></textarea>',\r\n      'fieldtemplate': true,\r\n      'inputfield': true\r\n    },\r\n    'wysihtml5':{\r\n      'template':'<textarea id=\"<%= id %>\" name=\"<%= node.name %>\" style=\"height:<%= elt.height || \"300px\" %>;width:<%= elt.width || \"100%\" %>;\"' +\r\n        ' aria-label=\"<%= node.title ? escape(node.title) : node.name %>\"' +\r\n        '<%= (fieldHtmlClass ? \"class=\\'\" + fieldHtmlClass + \"\\' \" : \"\") %>' +\r\n        '<%= (node.disabled? \" disabled\" : \"\")%>' +\r\n        '<%= (node.readOnly ? \" readonly=\\'readonly\\'\" : \"\") %>' +\r\n        '<%= (node.schemaElement && node.schemaElement.minLength ? \" minlength=\\'\" + node.schemaElement.minLength + \"\\'\" : \"\") %>' +\r\n        '<%= (node.schemaElement && node.schemaElement.maxLength ? \" maxlength=\\'\" + node.schemaElement.maxLength + \"\\'\" : \"\") %>' +\r\n        '<%= (node.schemaElement && node.schemaElement.required ? \" required=\\'required\\'\" : \"\") %>' +\r\n        '<%= (node.placeholder? \" placeholder=\" + \\'\"\\' + escape(node.placeholder) + \\'\"\\' : \"\")%>' +\r\n        '><%= value %></textarea>',\r\n      'fieldtemplate': true,\r\n      'inputfield': true,\r\n      'onInsert': function (evt, node) {\r\n        var setup = function () {\r\n          //protect from double init\r\n          if ($(node.el).data(\"wysihtml5\")) return;\r\n          $(node.el).data(\"wysihtml5_loaded\",true);\r\n\r\n          $(node.el).find('#' + util.escapeSelector(node.id)).wysihtml5({\r\n            \"html\": true,\r\n            \"link\": true,\r\n            \"font-styles\":true,\r\n            \"image\": false,\r\n            \"events\": {\r\n              \"load\": function () {\r\n                // In chrome, if an element is required and hidden, it leads to\r\n                // the error 'An invalid form control with name='' is not focusable'\r\n                // See http://stackoverflow.com/questions/7168645/invalid-form-control-only-in-google-chrome\r\n                $(this.textareaElement).removeAttr('required');\r\n              }\r\n            }\r\n          });\r\n        };\r\n\r\n        // Is there a setup hook?\r\n        if (window.jsonform_wysihtml5_setup) {\r\n          window.jsonform_wysihtml5_setup(setup);\r\n          return;\r\n        }\r\n\r\n        // Wait until wysihtml5 is loaded\r\n        var itv = window.setInterval(function() {\r\n          if (window.wysihtml5) {\r\n            window.clearInterval(itv);\r\n            setup();\r\n          }\r\n        },1000);\r\n      }\r\n    },\r\n    'ace':{\r\n      'template':'<div id=\"<%= id %>\" style=\"position:relative;height:<%= elt.height || \"300px\" %>;\"><div id=\"<%= id %>__ace\" style=\"width:<%= elt.width || \"100%\" %>;height:<%= elt.height || \"300px\" %>;\"></div><input type=\"hidden\" name=\"<%= node.name %>\" id=\"<%= id %>__hidden\" value=\"<%= escape(value) %>\"/></div>',\r\n      'fieldtemplate': true,\r\n      'inputfield': true,\r\n      'onInsert': function (evt, node) {\r\n        var setup = function () {\r\n          var formElement = node.formElement || {};\r\n          var ace = window.ace;\r\n          var editor = ace.edit($(node.el).find('#' + util.escapeSelector(node.id) + '__ace').get(0));\r\n          var idSelector = '#' + util.escapeSelector(node.id) + '__hidden';\r\n          // Force editor to use \"\\n\" for new lines, not to bump into ACE \"\\r\" conversion issue\r\n          // (ACE is ok with \"\\r\" on pasting but fails to return \"\\r\" when value is extracted)\r\n          editor.getSession().setNewLineMode('unix');\r\n          editor.renderer.setShowPrintMargin(false);\r\n          editor.setTheme(\"ace/theme/\"+(formElement.aceTheme||\"twilight\"));\r\n\r\n          if (formElement.aceMode) {\r\n            editor.getSession().setMode(\"ace/mode/\"+formElement.aceMode);\r\n          }\r\n          editor.getSession().setTabSize(2);\r\n\r\n          // Set the contents of the initial manifest file\r\n          editor.getSession().setValue(node.value||\"\");\r\n\r\n          //TODO: this is clearly sub-optimal\r\n          // 'Lazily' bind to the onchange 'ace' event to give\r\n          // priority to user edits\r\n          var lazyChanged = langx.debounce(function () {\r\n            $(node.el).find(idSelector).val(editor.getSession().getValue());\r\n            $(node.el).find(idSelector).change();\r\n          }, 600);\r\n          editor.getSession().on('change', lazyChanged);\r\n\r\n          editor.on('blur', function() {\r\n            $(node.el).find(idSelector).change();\r\n            $(node.el).find(idSelector).trigger(\"blur\");\r\n          });\r\n          editor.on('focus', function() {\r\n            $(node.el).find(idSelector).trigger(\"focus\");\r\n          });\r\n        };\r\n\r\n        // Is there a setup hook?\r\n        if (window.jsonform_ace_setup) {\r\n          window.jsonform_ace_setup(setup);\r\n          return;\r\n        }\r\n\r\n        // Wait until ACE is loaded\r\n        var itv = window.setInterval(function() {\r\n          if (window.ace) {\r\n            window.clearInterval(itv);\r\n            setup();\r\n          }\r\n        },1000);\r\n      }\r\n    },\r\n    'checkbox':{\r\n      'template': '<div class=\"checkbox\"><label><input type=\"checkbox\" id=\"<%= id %>\" ' +\r\n        '<%= (fieldHtmlClass ? \" class=\\'\" + fieldHtmlClass + \"\\'\": \"\") %>' +\r\n        'name=\"<%= node.name %>\" value=\"1\" <% if (value) {%>checked<% } %>' +\r\n        '<%= (node.disabled? \" disabled\" : \"\")%>' +\r\n        '<%= (node.schemaElement && node.schemaElement.required && (node.schemaElement.type !== \"boolean\") ? \" required=\\'required\\'\" : \"\") %>' +\r\n        ' /><%= node.inlinetitle || \"\" %>' +\r\n        '</label></div>',\r\n      'fieldtemplate': true,\r\n      'inputfield': true,\r\n      'getElement': function (el) {\r\n        return $(el).parent().get(0);\r\n      }\r\n    },\r\n    'file':{\r\n      'template':'<input class=\"input-file\" id=\"<%= id %>\" name=\"<%= node.name %>\" type=\"file\" ' +\r\n        '<%= (node.schemaElement && node.schemaElement.required ? \" required=\\'required\\'\" : \"\") %>' +\r\n        '<%= (node.formElement && node.formElement.accept ? (\" accept=\\'\" + node.formElement.accept + \"\\'\") : \"\") %>' +\r\n        '/>',\r\n      'fieldtemplate': true,\r\n      'inputfield': true\r\n    },\r\n    'file-hosted-public':{\r\n      'template':'<span><% if (value && (value.type||value.url)) { %>'+fileDisplayTemplate+'<% } %><input class=\"input-file\" id=\"_transloadit_<%= id %>\" type=\"file\" name=\"<%= transloaditname %>\" /><input data-transloadit-name=\"_transloadit_<%= transloaditname %>\" type=\"hidden\" id=\"<%= id %>\" name=\"<%= node.name %>\" value=\\'<%= escape(JSON.stringify(node.value)) %>\\' /></span>',\r\n      'fieldtemplate': true,\r\n      'inputfield': true,\r\n      'getElement': function (el) {\r\n        return $(el).parent().get(0);\r\n      },\r\n      'onBeforeRender': function (data, node) {\r\n\r\n        if (!node.ownerTree._transloadit_generic_public_index) {\r\n          node.ownerTree._transloadit_generic_public_index=1;\r\n        } else {\r\n          node.ownerTree._transloadit_generic_public_index++;\r\n        }\r\n\r\n        data.transloaditname = \"_transloadit_jsonform_genericupload_public_\"+node.ownerTree._transloadit_generic_public_index;\r\n\r\n        if (!node.ownerTree._transloadit_generic_elts) node.ownerTree._transloadit_generic_elts = {};\r\n        node.ownerTree._transloadit_generic_elts[data.transloaditname] = node;\r\n      },\r\n      'onChange': function(evt,elt) {\r\n        // The \"transloadit\" function should be called only once to enable\r\n        // the service when the form is submitted. Has it already been done?\r\n        if (elt.ownerTree._transloadit_bound) {\r\n          return false;\r\n        }\r\n        elt.ownerTree._transloadit_bound = true;\r\n\r\n        // Call the \"transloadit\" function on the form element\r\n        var formElt = $(elt.ownerTree.domRoot);\r\n        formElt.transloadit({\r\n          autoSubmit: false,\r\n          wait: true,\r\n          onSuccess: function (assembly) {\r\n            // Image has been uploaded. Check the \"results\" property that\r\n            // contains the list of files that Transloadit produced. There\r\n            // should be one image per file input in the form at most.\r\n            var results = langx.values(assembly.results);\r\n            results = langx.flatten(results);\r\n            util.each(results, function (result) {\r\n              // Save the assembly result in the right hidden input field\r\n              var id = elt.ownerTree._transloadit_generic_elts[result.field].id;\r\n              var input = formElt.find('#' + util.escapeSelector(id));\r\n              var nonEmptyKeys = langx.filter(langx.keys(result.meta), function (key) {\r\n                return !!util.isSet(result.meta[key]);\r\n              });\r\n              result.meta = langx.pick(result.meta, nonEmptyKeys);\r\n              input.val(JSON.stringify(result));\r\n            });\r\n\r\n            // Unbind transloadit from the form\r\n            elt.ownerTree._transloadit_bound = false;\r\n            formElt.unbind('submit.transloadit');\r\n\r\n            // Submit the form on next tick\r\n            langx.defer(function () {  //_.dalay\r\n              elt.ownerTree.submit();\r\n            }, 10);\r\n          },\r\n          onError: function (assembly) {\r\n            // TODO: report the error to the user\r\n            console.log('assembly error', assembly);\r\n          }\r\n        });\r\n      },\r\n      'onInsert': function (evt, node) {\r\n        $(node.el).find('a._jsonform-delete').on('click', function (evt) {\r\n          $(node.el).find('._jsonform-preview').remove();\r\n          $(node.el).find('a._jsonform-delete').remove();\r\n          $(node.el).find('#' + util.escapeSelector(node.id)).val('');\r\n          evt.preventDefault();\r\n          return false;\r\n        });\r\n      },\r\n      'onSubmit':function(evt, elt) {\r\n        if (elt.ownerTree._transloadit_bound) {\r\n          return false;\r\n        }\r\n        return true;\r\n      }\r\n\r\n    },\r\n    'file-transloadit': {\r\n      'template': '<span><% if (value && (value.type||value.url)) { %>'+fileDisplayTemplate+'<% } %><input class=\"input-file\" id=\"_transloadit_<%= id %>\" type=\"file\" name=\"_transloadit_<%= node.name %>\" /><input type=\"hidden\" id=\"<%= id %>\" name=\"<%= node.name %>\" value=\\'<%= escape(JSON.stringify(node.value)) %>\\' /></span>',\r\n      'fieldtemplate': true,\r\n      'inputfield': true,\r\n      'getElement': function (el) {\r\n        return $(el).parent().get(0);\r\n      },\r\n      'onChange': function (evt, elt) {\r\n        // The \"transloadit\" function should be called only once to enable\r\n        // the service when the form is submitted. Has it already been done?\r\n        if (elt.ownerTree._transloadit_bound) {\r\n          return false;\r\n        }\r\n        elt.ownerTree._transloadit_bound = true;\r\n\r\n        // Call the \"transloadit\" function on the form element\r\n        var formElt = $(elt.ownerTree.domRoot);\r\n        formElt.transloadit({\r\n          autoSubmit: false,\r\n          wait: true,\r\n          onSuccess: function (assembly) {\r\n            // Image has been uploaded. Check the \"results\" property that\r\n            // contains the list of files that Transloadit produced. Note\r\n            // JSONForm only supports 1-to-1 associations, meaning it\r\n            // expects the \"results\" property to contain only one image\r\n            // per file input in the form.\r\n            var results = langx.values(assembly.results);\r\n            results = langx.flatten(results);\r\n            util.each(results, function (result) {\r\n              // Save the assembly result in the right hidden input field\r\n              var input = formElt.find('input[name=\"' +\r\n                result.field.replace(/^_transloadit_/, '') +\r\n                '\"]');\r\n              var nonEmptyKeys = langx.filter(langx.keys(result.meta), function (key) {\r\n                return !!util.isSet(result.meta[key]);\r\n              });\r\n              result.meta = langx.pick(result.meta, nonEmptyKeys);\r\n              input.val(JSON.stringify(result));\r\n            });\r\n\r\n            // Unbind transloadit from the form\r\n            elt.ownerTree._transloadit_bound = false;\r\n            formElt.unbind('submit.transloadit');\r\n\r\n            // Submit the form on next tick\r\n            langx.defer(function () { //_.delay\r\n              elt.ownerTree.submit();\r\n            }, 10);\r\n          },\r\n          onError: function (assembly) {\r\n            // TODO: report the error to the user\r\n            console.log('assembly error', assembly);\r\n          }\r\n        });\r\n      },\r\n      'onInsert': function (evt, node) {\r\n        $(node.el).find('a._jsonform-delete').on('click', function (evt) {\r\n          $(node.el).find('._jsonform-preview').remove();\r\n          $(node.el).find('a._jsonform-delete').remove();\r\n          $(node.el).find('#' + util.escapeSelector(node.id)).val('');\r\n          evt.preventDefault();\r\n          return false;\r\n        });\r\n      },\r\n      'onSubmit': function (evt, elt) {\r\n        if (elt.ownerTree._transloadit_bound) {\r\n          return false;\r\n        }\r\n        return true;\r\n      }\r\n    },\r\n    'select':{\r\n      'template':'<select name=\"<%= node.name %>\" id=\"<%= id %>\"' +\r\n        'class=\\'form-control<%= (fieldHtmlClass ? \" \" + fieldHtmlClass : \"\") %>\\'' +\r\n        '<%= (node.schemaElement && node.schemaElement.disabled? \" disabled\" : \"\")%>' +\r\n        '<%= (node.schemaElement && node.schemaElement.required ? \" required=\\'required\\'\" : \"\") %>' +\r\n        '> ' +\r\n        '<% _.forEach(node.options, function(key, val) { if(key instanceof Object) { if (value === key.value) { %> <option selected value=\"<%= key.value %>\"><%= key.title %></option> <% } else { %> <option value=\"<%= key.value %>\"><%= key.title %></option> <% }} else { if (value === key) { %> <option selected value=\"<%= key %>\"><%= key %></option> <% } else { %><option value=\"<%= key %>\"><%= key %></option> <% }}}); %> ' +\r\n        '</select>',\r\n      'fieldtemplate': true,\r\n      'inputfield': true\r\n    },\r\n    'imageselect': {\r\n      'template': '<div>' +\r\n        '<input type=\"hidden\" name=\"<%= node.name %>\" id=\"<%= node.id %>\" value=\"<%= value %>\" />' +\r\n        '<div class=\"dropdown\">' +\r\n        '<a class=\"btn<% if (buttonClass && node.value) { %> <%= buttonClass %><% } else { %> btn-default<% } %>\" data-toggle=\"dropdown\" href=\"#\"<% if (node.value) { %> style=\"max-width:<%= width %>px;max-height:<%= height %>px\"<% } %>>' +\r\n          '<% if (node.value) { %><img src=\"<% if (!node.value.match(/^https?:/)) { %><%= prefix %><% } %><%= node.value %><%= suffix %>\" alt=\"\" /><% } else { %><%= buttonTitle %><% } %>' +\r\n        '</a>' +\r\n        '<div class=\"dropdown-menu navbar\" id=\"<%= node.id %>_dropdown\">' +\r\n          '<div>' +\r\n          '<% _.forEach(node.options, function(key, idx) { if ((idx > 0) && ((idx % columns) === 0)) { %></div><div><% } %><a class=\"btn<% if (buttonClass) { %> <%= buttonClass %><% } else { %> btn-default<% } %>\" style=\"max-width:<%= width %>px;max-height:<%= height %>px\"><% if (key instanceof Object) { %><img src=\"<% if (!key.value.match(/^https?:/)) { %><%= prefix %><% } %><%= key.value %><%= suffix %>\" alt=\"<%= key.title %>\" /></a><% } else { %><img src=\"<% if (!key.match(/^https?:/)) { %><%= prefix %><% } %><%= key %><%= suffix %>\" alt=\"\" /><% } %></a> <% }); %>' +\r\n          '</div>' +\r\n          '<div class=\"pagination-right\"><a class=\"btn btn-default\">Reset</a></div>' +\r\n        '</div>' +\r\n        '</div>' +\r\n        '</div>',\r\n      'fieldtemplate': true,\r\n      'inputfield': true,\r\n      'onBeforeRender': function (data, node) {\r\n        var elt = node.formElement || {};\r\n        var nbRows = null;\r\n        var maxColumns = elt.imageSelectorColumns || 5;\r\n        data.buttonTitle = elt.imageSelectorTitle || 'Select...';\r\n        data.prefix = elt.imagePrefix || '';\r\n        data.suffix = elt.imageSuffix || '';\r\n        data.width = elt.imageWidth || 32;\r\n        data.height = elt.imageHeight || 32;\r\n        data.buttonClass = elt.imageButtonClass || false;\r\n        if (node.options.length > maxColumns) {\r\n          nbRows = Math.ceil(node.options.length / maxColumns);\r\n          data.columns = Math.ceil(node.options.length / nbRows);\r\n        }\r\n        else {\r\n          data.columns = maxColumns;\r\n        }\r\n      },\r\n      'getElement': function (el) {\r\n        return $(el).parent().get(0);\r\n      },\r\n      'onInsert': function (evt, node) {\r\n        $(node.el).on('click', '.dropdown-menu a', function (evt) {\r\n          evt.preventDefault();\r\n          evt.stopPropagation();\r\n          var img = (evt.target.nodeName.toLowerCase() === 'img') ?\r\n            $(evt.target) :\r\n            $(evt.target).find('img');\r\n          var value = img.attr('src');\r\n          var elt = node.formElement || {};\r\n          var prefix = elt.imagePrefix || '';\r\n          var suffix = elt.imageSuffix || '';\r\n          var width = elt.imageWidth || 32;\r\n          var height = elt.imageHeight || 32;\r\n          if (value) {\r\n            if (value.indexOf(prefix) === 0) {\r\n              value = value.substring(prefix.length);\r\n            }\r\n            value = value.substring(0, value.length - suffix.length);\r\n            $(node.el).find('input').attr('value', value);\r\n            $(node.el).find('a[data-toggle=\"dropdown\"]')\r\n              .addClass(elt.imageButtonClass)\r\n              .attr('style', 'max-width:' + width + 'px;max-height:' + height + 'px')\r\n              .html('<img src=\"' + (!value.match(/^https?:/) ? prefix : '') + value + suffix + '\" alt=\"\" />');\r\n          }\r\n          else {\r\n            $(node.el).find('input').attr('value', '');\r\n            $(node.el).find('a[data-toggle=\"dropdown\"]')\r\n              .removeClass(elt.imageButtonClass)\r\n              .removeAttr('style')\r\n              .html(elt.imageSelectorTitle || 'Select...');\r\n          }\r\n        });\r\n      }\r\n    },\r\n    'iconselect': {\r\n      'template': '<div>' +\r\n        '<input type=\"hidden\" name=\"<%= node.name %>\" id=\"<%= node.id %>\" value=\"<%= value %>\" />' +\r\n        '<div class=\"dropdown\">' +\r\n        '<a class=\"btn<% if (buttonClass && node.value) { %> <%= buttonClass %><% } %>\" data-toggle=\"dropdown\" href=\"#\"<% if (node.value) { %> style=\"max-width:<%= width %>px;max-height:<%= height %>px\"<% } %>>' +\r\n          '<% if (node.value) { %><i class=\"icon-<%= node.value %>\" /><% } else { %><%= buttonTitle %><% } %>' +\r\n        '</a>' +\r\n        '<div class=\"dropdown-menu navbar\" id=\"<%= node.id %>_dropdown\">' +\r\n          '<div>' +\r\n          '<% _.forEach(node.options, function(key, idx) { if ((idx > 0) && ((idx % columns) === 0)) { %></div><div><% } %><a class=\"btn<% if (buttonClass) { %> <%= buttonClass %><% } %>\" ><% if (key instanceof Object) { %><i class=\"icon-<%= key.value %>\" alt=\"<%= key.title %>\" /></a><% } else { %><i class=\"icon-<%= key %>\" alt=\"\" /><% } %></a> <% }); %>' +\r\n          '</div>' +\r\n          '<div class=\"pagination-right\"><a class=\"btn\">Reset</a></div>' +\r\n        '</div>' +\r\n        '</div>' +\r\n        '</div>',\r\n      'fieldtemplate': true,\r\n      'inputfield': true,\r\n      'onBeforeRender': function (data, node) {\r\n        var elt = node.formElement || {};\r\n        var nbRows = null;\r\n        var maxColumns = elt.imageSelectorColumns || 5;\r\n        data.buttonTitle = elt.imageSelectorTitle || 'Select...';\r\n        data.buttonClass = elt.imageButtonClass || false;\r\n        if (node.options.length > maxColumns) {\r\n          nbRows = Math.ceil(node.options.length / maxColumns);\r\n          data.columns = Math.ceil(node.options.length / nbRows);\r\n        }\r\n        else {\r\n          data.columns = maxColumns;\r\n        }\r\n      },\r\n      'getElement': function (el) {\r\n        return $(el).parent().get(0);\r\n      },\r\n      'onInsert': function (evt, node) {\r\n        $(node.el).on('click', '.dropdown-menu a', function (evt) {\r\n          evt.preventDefault();\r\n          evt.stopPropagation();\r\n          var i = (evt.target.nodeName.toLowerCase() === 'i') ?\r\n            $(evt.target) :\r\n            $(evt.target).find('i');\r\n          var value = i.attr('class');\r\n          var elt = node.formElement || {};\r\n          if (value) {\r\n            value = value;\r\n            $(node.el).find('input').attr('value', value);\r\n            $(node.el).find('a[data-toggle=\"dropdown\"]')\r\n              .addClass(elt.imageButtonClass)\r\n              .html('<i class=\"'+ value +'\" alt=\"\" />');\r\n          }\r\n          else {\r\n            $(node.el).find('input').attr('value', '');\r\n            $(node.el).find('a[data-toggle=\"dropdown\"]')\r\n              .removeClass(elt.imageButtonClass)\r\n              .html(elt.imageSelectorTitle || 'Select...');\r\n          }\r\n        });\r\n      }\r\n    },\r\n    'radios':{\r\n      'template': '<div id=\"<%= node.id %>\"><% _.forEach(node.options, function(key, val) { %><div class=\"radio\"><label><input<%= (fieldHtmlClass ? \" class=\\'\" + fieldHtmlClass + \"\\'\": \"\") %> type=\"radio\" <% if (((key instanceof Object) && (value === key.value)) || (value === key)) { %> checked=\"checked\" <% } %> name=\"<%= node.name %>\" value=\"<%= (key instanceof Object ? key.value : key) %>\"' +\r\n        '<%= (node.disabled? \" disabled\" : \"\")%>' +\r\n        '<%= (node.schemaElement && node.schemaElement.required ? \" required=\\'required\\'\" : \"\") %>' +\r\n        '/><%= (key instanceof Object ? key.title : key) %></label></div> <% }); %></div>',\r\n      'fieldtemplate': true,\r\n      'inputfield': true\r\n    },\r\n    'radiobuttons': {\r\n      'template': '<div id=\"<%= node.id %>\">' +\r\n        '<% _.forEach(node.options, function(key, val) { %>' +\r\n          '<label class=\"btn btn-default <% if (((key instanceof Object) && (value === key.value)) || (value === key)) { %>active btn-success<% } %>\">' +\r\n          '<input<%= (fieldHtmlClass ? \" class=\\'\" + fieldHtmlClass + \"\\'\": \"\") %> type=\"radio\" style=\"position:absolute;left:-9999px;\" ' +\r\n          '<% if (((key instanceof Object) && (value === key.value)) || (value === key)) { %> checked=\"checked\" <% } %> name=\"<%= node.name %>\" value=\"<%= (key instanceof Object ? key.value : key) %>\" />' +\r\n          '<span><%= (key instanceof Object ? key.title : key) %></span></label> ' +\r\n          '<% }); %>' +\r\n        '</div>',\r\n      'fieldtemplate': true,\r\n      'inputfield': true,\r\n      'onInsert': function (evt, node) {\r\n        var activeClass = 'active';\r\n        var elt = node.formElement || {};\r\n        if (elt.activeClass) {\r\n          activeClass += ' ' + elt.activeClass;\r\n        }\r\n        $(node.el).find('label').on('click', function () {\r\n          $(this).parent().find('label').removeClass(activeClass);\r\n          $(this).addClass(activeClass);\r\n        });\r\n      }\r\n    },\r\n    'checkboxes':{\r\n      'template': '<div><%= choiceshtml %></div>',\r\n      'fieldtemplate': true,\r\n      'inputfield': true,\r\n      'onBeforeRender': function (data, node) {\r\n        // Build up choices from the enumeration list\r\n        var choices = null;\r\n        var choiceshtml = null;\r\n        var template = '<div class=\"checkbox\"><label>' +\r\n          '<input type=\"checkbox\" <% if (value) { %> checked=\"checked\" <% } %> name=\"<%= name %>\" value=\"1\"' +\r\n          '<%= (node.disabled? \" disabled\" : \"\")%>' +\r\n          '/><%= title %></label></div>';\r\n        if (!node || !node.schemaElement) return;\r\n\r\n        if (node.schemaElement.items) {\r\n          choices =\r\n            node.schemaElement.items[\"enum\"] ||\r\n            node.schemaElement.items[0][\"enum\"];\r\n        } else {\r\n          choices = node.schemaElement[\"enum\"];\r\n        }\r\n        if (!choices) return;\r\n\r\n        choiceshtml = '';\r\n        util.each(choices, function (choice, idx) {\r\n          choiceshtml += langx.template(template, util.fieldTemplateSettings)({\r\n            name: node.key + '[' + idx + ']',\r\n            value: langx.contains(node.value, choice),\r\n            title: util.hasOwnProperty(node.formElement.titleMap, choice) ? node.formElement.titleMap[choice] : choice,\r\n            node: node\r\n          });\r\n        });\r\n\r\n        data.choiceshtml = choiceshtml;\r\n      }\r\n    },\r\n    'array': {\r\n      'template': '<div id=\"<%= id %>\"><ul class=\"_jsonform-array-ul\" style=\"list-style-type:none;\"><%= children %></ul>' +\r\n        '<span class=\"_jsonform-array-buttons\">' +\r\n          '<a href=\"#\" class=\"btn btn-default _jsonform-array-addmore\"><i class=\"glyphicon glyphicon-plus-sign\" title=\"Add new\"></i></a> ' +\r\n          '<a href=\"#\" class=\"btn btn-default _jsonform-array-deletelast\"><i class=\"glyphicon glyphicon-minus-sign\" title=\"Delete last\"></i></a>' +\r\n        '</span>' +\r\n        '</div>',\r\n      'fieldtemplate': true,\r\n      'array': true,\r\n      'childTemplate': function (inner, enableDrag) {\r\n        if ($('').sortable) {\r\n          // Insert a \"draggable\" icon\r\n          // floating to the left of the main element\r\n          return '<li data-idx=\"<%= node.childPos %>\">' +\r\n            // only allow drag of children if enabled\r\n            (enableDrag ? '<span class=\"draggable line\"><i class=\"glyphicon glyphicon-list\" title=\"Move item\"></i></span>' : '') +\r\n            inner +\r\n            '</li>';\r\n        }\r\n        else {\r\n          return '<li data-idx=\"<%= node.childPos %>\">' +\r\n            inner +\r\n            '</li>';\r\n        }\r\n      },\r\n      'onInsert': function (evt, node) {\r\n        var $nodeid = $(node.el).find('#' + util.escapeSelector(node.id));\r\n        var boundaries = node.getArrayBoundaries();\r\n\r\n        // Switch two nodes in an array\r\n        var moveNodeTo = function (fromIdx, toIdx) {\r\n          // Note \"switchValuesWith\" extracts values from the DOM since field\r\n          // values are not synchronized with the tree data structure, so calls\r\n          // to render are needed at each step to force values down to the DOM\r\n          // before next move.\r\n          // TODO: synchronize field values and data structure completely and\r\n          // call render only once to improve efficiency.\r\n          if (fromIdx === toIdx) return;\r\n          var incr = (fromIdx < toIdx) ? 1: -1;\r\n          var i = 0;\r\n          var parentEl = $('> ul', $nodeid);\r\n          for (i = fromIdx; i !== toIdx; i += incr) {\r\n            node.children[i].switchValuesWith(node.children[i + incr]);\r\n            node.children[i].render(parentEl.get(0));\r\n            node.children[i + incr].render(parentEl.get(0));\r\n          }\r\n\r\n          // No simple way to prevent DOM reordering with jQuery UI Sortable,\r\n          // so we're going to need to move sorted DOM elements back to their\r\n          // origin position in the DOM ourselves (we switched values but not\r\n          // DOM elements)\r\n          var fromEl = $(node.children[fromIdx].el);\r\n          var toEl = $(node.children[toIdx].el);\r\n          fromEl.detach();\r\n          toEl.detach();\r\n          if (fromIdx < toIdx) {\r\n            if (fromIdx === 0) parentEl.prepend(fromEl);\r\n            else $(node.children[fromIdx-1].el).after(fromEl);\r\n            $(node.children[toIdx-1].el).after(toEl);\r\n          }\r\n          else {\r\n            if (toIdx === 0) parentEl.prepend(toEl);\r\n            else $(node.children[toIdx-1].el).after(toEl);\r\n            $(node.children[fromIdx-1].el).after(fromEl);\r\n          }\r\n        };\r\n\r\n        $('> span > a._jsonform-array-addmore', $nodeid).click(function (evt) {\r\n          evt.preventDefault();\r\n          evt.stopPropagation();\r\n          var idx = node.children.length;\r\n          if (boundaries.maxItems >= 0) {\r\n            if (node.children.length > boundaries.maxItems - 2) {\r\n              $nodeid.find('> span > a._jsonform-array-addmore')\r\n                .addClass('disabled');\r\n            }\r\n            if (node.children.length > boundaries.maxItems - 1) {\r\n              return false;\r\n            }\r\n          }\r\n          node.insertArrayItem(idx, $('> ul', $nodeid).get(0));\r\n          if ((boundaries.minItems <= 0) ||\r\n              ((boundaries.minItems > 0) &&\r\n                (node.children.length > boundaries.minItems - 1))) {\r\n            $nodeid.find('> span > a._jsonform-array-deletelast')\r\n              .removeClass('disabled');\r\n          }\r\n        });\r\n\r\n        //Simulate Users click to setup the form with its minItems\r\n        var curItems = $('> ul > li', $nodeid).length;\r\n        if ((boundaries.minItems > 0) &&\r\n            (curItems < boundaries.minItems)) {\r\n          for (var i = 0; i < (boundaries.minItems - 1) && ($nodeid.find('> ul > li').length < boundaries.minItems); i++) {\r\n            node.insertArrayItem(curItems, $nodeid.find('> ul').get(0));\r\n          }\r\n        }\r\n        if ((boundaries.minItems > 0) &&\r\n            (node.children.length <= boundaries.minItems)) {\r\n          $nodeid.find('> span > a._jsonform-array-deletelast')\r\n            .addClass('disabled');\r\n        }\r\n\r\n        $('> span > a._jsonform-array-deletelast', $nodeid).click(function (evt) {\r\n          var idx = node.children.length - 1;\r\n          evt.preventDefault();\r\n          evt.stopPropagation();\r\n          if (boundaries.minItems > 0) {\r\n            if (node.children.length < boundaries.minItems + 2) {\r\n              $nodeid.find('> span > a._jsonform-array-deletelast')\r\n                .addClass('disabled');\r\n            }\r\n            if (node.children.length <= boundaries.minItems) {\r\n              return false;\r\n            }\r\n          }\r\n          else if (node.children.length === 1) {\r\n            $nodeid.find('> span > a._jsonform-array-deletelast')\r\n              .addClass('disabled');\r\n          }\r\n          node.deleteArrayItem(idx);\r\n          if ((boundaries.maxItems >= 0) && (idx <= boundaries.maxItems - 1)) {\r\n            $nodeid.find('> span > a._jsonform-array-addmore')\r\n              .removeClass('disabled');\r\n          }\r\n        });\r\n\r\n        // only allow drag if default or enabled\r\n        if (!util.isSet(node.formElement.draggable) || node.formElement.draggable) {\r\n          if ($(node.el).sortable) {\r\n            $('> ul', $nodeid).sortable();\r\n            $('> ul', $nodeid).bind('sortstop', function (event, ui) {\r\n              var idx = $(ui.item).data('idx');\r\n              var newIdx = $(ui.item).index();\r\n              moveNodeTo(idx, newIdx);\r\n            });\r\n          }\r\n        }\r\n      }\r\n    },\r\n    'tabarray': {\r\n      'template': '<div id=\"<%= id %>\"><div class=\"tabbable tabs-left\">' +\r\n        '<ul class=\"nav nav-tabs\">' +\r\n          '<%= tabs %>' +\r\n        '</ul>' +\r\n        '<div class=\"tab-content\">' +\r\n          '<%= children %>' +\r\n        '</div>' +\r\n        '</div>' +\r\n        '<a href=\"#\" class=\"btn btn-default _jsonform-array-addmore\"><i class=\"glyphicon glyphicon-plus-sign\" title=\"Add new\"></i></a> ' +\r\n        '<a href=\"#\" class=\"btn btn-default _jsonform-array-deleteitem\"><i class=\"glyphicon glyphicon-minus-sign\" title=\"Delete item\"></i></a></div>',\r\n      'fieldtemplate': true,\r\n      'array': true,\r\n      'childTemplate': function (inner) {\r\n        return '<div data-idx=\"<%= node.childPos %>\" class=\"tab-pane\">' +\r\n          inner +\r\n          '</div>';\r\n      },\r\n      'onBeforeRender': function (data, node) {\r\n        // Generate the initial 'tabs' from the children\r\n        var tabs = '';\r\n        util.each(node.children, function (child, idx) {\r\n          var title = child.legend ||\r\n            child.title ||\r\n            ('Item ' + (idx+1));\r\n          tabs += '<li data-idx=\"' + idx + '\"' +\r\n            ((idx === 0) ? ' class=\"active\"' : '') +\r\n            '><a class=\"draggable tab\" data-toggle=\"tab\" rel=\"' + escape(title) + '\">' +\r\n            langx.escapeHTML(title) +\r\n            '</a></li>';\r\n        });\r\n        data.tabs = tabs;\r\n      },\r\n      'onInsert': function (evt, node) {\r\n        var $nodeid = $(node.el).find('#' + util.escapeSelector(node.id));\r\n        var boundaries = node.getArrayBoundaries();\r\n\r\n        var moveNodeTo = function (fromIdx, toIdx) {\r\n          // Note \"switchValuesWith\" extracts values from the DOM since field\r\n          // values are not synchronized with the tree data structure, so calls\r\n          // to render are needed at each step to force values down to the DOM\r\n          // before next move.\r\n          // TODO: synchronize field values and data structure completely and\r\n          // call render only once to improve efficiency.\r\n          if (fromIdx === toIdx) return;\r\n          var incr = (fromIdx < toIdx) ? 1: -1;\r\n          var i = 0;\r\n          var tabEl = $('> .tabbable > .tab-content', $nodeid).get(0);\r\n          for (i = fromIdx; i !== toIdx; i += incr) {\r\n            node.children[i].switchValuesWith(node.children[i + incr]);\r\n            node.children[i].render(tabEl);\r\n            node.children[i + incr].render(tabEl);\r\n          }\r\n        };\r\n\r\n\r\n        // Refreshes the list of tabs\r\n        var updateTabs = function (selIdx) {\r\n          var tabs = '';\r\n          var activateFirstTab = false;\r\n          if (selIdx === undefined) {\r\n            selIdx = $('> .tabbable > .nav-tabs .active', $nodeid).data('idx');\r\n            if (selIdx) {\r\n              selIdx = parseInt(selIdx, 10);\r\n            }\r\n            else {\r\n              activateFirstTab = true;\r\n              selIdx = 0;\r\n            }\r\n          }\r\n          if (selIdx >= node.children.length) {\r\n            selIdx = node.children.length - 1;\r\n          }\r\n          util.each(node.children, function (child, idx) {\r\n            $('> .tabbable > .tab-content > [data-idx=\"' + idx + '\"] > fieldset > legend', $nodeid).html(child.legend);\r\n            var title = child.legend || child.title || ('Item ' + (idx+1));\r\n            tabs += '<li data-idx=\"' + idx + '\">' +\r\n                    '<a class=\"draggable tab\" data-toggle=\"tab\" rel=\"' + escape(title) + '\">' +\r\n                    langx.escapeHTML(title) +\r\n                    '</a></li>';\r\n          });\r\n          $('> .tabbable > .nav-tabs', $nodeid).html(tabs);\r\n          if (activateFirstTab) {\r\n            $('> .tabbable > .nav-tabs [data-idx=\"0\"]', $nodeid).addClass('active');\r\n          }\r\n          $('> .tabbable > .nav-tabs [data-toggle=\"tab\"]', $nodeid).eq(selIdx).click();\r\n        };\r\n\r\n        $('> a._jsonform-array-deleteitem', $nodeid).click(function (evt) {\r\n          var idx = Number($('> .tabbable > .nav-tabs .active', $nodeid).data('idx'));\r\n          evt.preventDefault();\r\n          evt.stopPropagation();\r\n          if (boundaries.minItems > 0) {\r\n            if (node.children.length < boundaries.minItems + 1) {\r\n              $nodeid.find('> a._jsonform-array-deleteitem')\r\n                .addClass('disabled');\r\n            }\r\n            if (node.children.length <= boundaries.minItems) return false;\r\n          }\r\n          node.deleteArrayItem(idx);\r\n          updateTabs();\r\n          if ((node.children.length < boundaries.minItems + 1) ||\r\n              (node.children.length === 0)) {\r\n            $nodeid.find('> a._jsonform-array-deleteitem').addClass('disabled');\r\n          }\r\n          if ((boundaries.maxItems >= 0) &&\r\n              (node.children.length <= boundaries.maxItems)) {\r\n            $nodeid.find('> a._jsonform-array-addmore').removeClass('disabled');\r\n          }\r\n        });\r\n\r\n        $('> a._jsonform-array-addmore', $nodeid).click(function (evt) {\r\n          var idx = node.children.length;\r\n          if (boundaries.maxItems>=0) {\r\n            if (node.children.length>boundaries.maxItems-2) {\r\n              $('> a._jsonform-array-addmore', $nodeid).addClass(\"disabled\");\r\n            }\r\n            if (node.children.length > boundaries.maxItems - 1) {\r\n              return false;\r\n            }\r\n          }\r\n          evt.preventDefault();\r\n          evt.stopPropagation();\r\n          node.insertArrayItem(idx,\r\n            $nodeid.find('> .tabbable > .tab-content').get(0));\r\n          updateTabs(idx);\r\n          if ((boundaries.minItems <= 0) ||\r\n              ((boundaries.minItems > 0) && (idx > boundaries.minItems - 1))) {\r\n            $nodeid.find('> a._jsonform-array-deleteitem').removeClass('disabled');\r\n          }\r\n        });\r\n\r\n        $(node.el).on('legendUpdated', function (evt) {\r\n          updateTabs();\r\n          evt.preventDefault();\r\n          evt.stopPropagation();\r\n        });\r\n\r\n        // only allow drag if default or enabled\r\n        if (!util.isSet(node.formElement.draggable) || node.formElement.draggable) {\r\n          if ($(node.el).sortable) {\r\n            $('> .tabbable > .nav-tabs', $nodeid).sortable({\r\n              containment: node.el,\r\n              tolerance: 'pointer'\r\n            });\r\n            $('> .tabbable > .nav-tabs', $nodeid).bind('sortstop', function (event, ui) {\r\n              var idx = $(ui.item).data('idx');\r\n              var newIdx = $(ui.item).index();\r\n              moveNodeTo(idx, newIdx);\r\n              updateTabs(newIdx);\r\n            });\r\n          }\r\n        }\r\n\r\n        // Simulate User's click to setup the form with its minItems\r\n        if ((boundaries.minItems >= 0)  &&\r\n            (node.children.length <= boundaries.minItems)) {\r\n          for (var i = 0; i < (boundaries.minItems - 1); i++) {\r\n            $nodeid.find('> a._jsonform-array-addmore').click();\r\n          }\r\n          $nodeid.find('> a._jsonform-array-deleteitem').addClass('disabled');\r\n          updateTabs();\r\n        }\r\n\r\n        if ((boundaries.maxItems >= 0) &&\r\n            (node.children.length >= boundaries.maxItems)) {\r\n          $nodeid.find('> a._jsonform-array-addmore').addClass('disabled');\r\n        }\r\n        if ((boundaries.minItems >= 0) &&\r\n            (node.children.length <= boundaries.minItems)) {\r\n          $nodeid.find('> a._jsonform-array-deleteitem').addClass('disabled');\r\n        }\r\n      }\r\n    },\r\n    'help': {\r\n      'template':'<span class=\"help-block\" style=\"padding-top:5px\"><%= elt.helpvalue %></span>',\r\n      'fieldtemplate': true\r\n    },\r\n    'msg': {\r\n      'template': '<%= elt.msg %>'\r\n    },\r\n    'fieldset': {\r\n      'template': '<fieldset class=\"form-group jsonform-error-<%= keydash %> <% if (elt.expandable) { %>expandable<% } %> <%= elt.htmlClass?elt.htmlClass:\"\" %>\" ' +\r\n        '<% if (id) { %> id=\"<%= id %>\"<% } %>' +\r\n        '>' +\r\n        '<% if (node.title || node.legend) { %><legend role=\"treeitem\" aria-expanded=\"false\"><%= node.title || node.legend %></legend><% } %>' +\r\n        '<% if (elt.expandable) { %><div class=\"form-group\"><% } %>' +\r\n        '<%= children %>' +\r\n        '<% if (elt.expandable) { %></div><% } %>' +\r\n        '</fieldset>',\r\n      onInsert: function (evt, node) {\r\n        if (node.el !== null) {\r\n          $('.expandable > div, .expandable > fieldset', node.el).hide();\r\n          // See #233\r\n          $(\".expandable\", node.el).removeClass(\"expanded\");\r\n        }\r\n      }\r\n    },\r\n    'advancedfieldset': {\r\n      'template': '<fieldset' +\r\n        '<% if (id) { %> id=\"<%= id %>\"<% } %>' +\r\n        ' class=\"expandable <%= elt.htmlClass?elt.htmlClass:\"\" %>\">' +\r\n        '<legend role=\"treeitem\" aria-expanded=\"false\"><%= (node.title || node.legend) ? (node.title || node.legend) : \"Advanced options\" %></legend>' +\r\n        '<div class=\"form-group\">' +\r\n        '<%= children %>' +\r\n        '</div>' +\r\n        '</fieldset>',\r\n      onInsert: function (evt, node) {\r\n        if (node.el !== null) {\r\n          $('.expandable > div, .expandable > fieldset', node.el).hide();\r\n          // See #233\r\n          $(\".expandable\", node.el).removeClass(\"expanded\");\r\n        }\r\n      }\r\n    },\r\n    'authfieldset': {\r\n      'template': '<fieldset' +\r\n        '<% if (id) { %> id=\"<%= id %>\"<% } %>' +\r\n        ' class=\"expandable <%= elt.htmlClass?elt.htmlClass:\"\" %>\">' +\r\n        '<legend role=\"treeitem\" aria-expanded=\"false\"><%= (node.title || node.legend) ? (node.title || node.legend) : \"Authentication settings\" %></legend>' +\r\n        '<div class=\"form-group\">' +\r\n        '<%= children %>' +\r\n        '</div>' +\r\n        '</fieldset>',\r\n      onInsert: function (evt, node) {\r\n        if (node.el !== null) {\r\n          $('.expandable > div, .expandable > fieldset', node.el).hide();\r\n          // See #233\r\n          $(\".expandable\", node.el).removeClass(\"expanded\");\r\n        }\r\n      }\r\n    },\r\n    'submit':{\r\n      'template':'<input type=\"submit\" <% if (id) { %> id=\"<%= id %>\" <% } %> class=\"btn btn-primary <%= elt.htmlClass?elt.htmlClass:\"\" %>\" value=\"<%= value || node.title %>\"<%= (node.disabled? \" disabled\" : \"\")%>/>'\r\n    },\r\n    'button':{\r\n      'template':' <button type=\"button\" <% if (id) { %> id=\"<%= id %>\" <% } %> class=\"btn btn-default <%= elt.htmlClass?elt.htmlClass:\"\" %>\"><%= node.title %></button> '\r\n    },\r\n    'actions':{\r\n      'template':'<div class=\"<%= elt.htmlClass?elt.htmlClass:\"\" %>\"><%= children %></div>'\r\n    },\r\n    'hidden':{\r\n      'template':'<input type=\"hidden\" id=\"<%= id %>\" name=\"<%= node.name %>\" value=\"<%= escape(value) %>\" />',\r\n      'inputfield': true\r\n    },\r\n    'tabs':{\r\n      'template':'<ul class=\"nav nav-tabs <%= elt.htmlClass?elt.htmlClass:\"\" %>\"' +\r\n      '<% if (elt.id) { %> id=\"<%= elt.id %>\"<% } %>' +\r\n      '><%=tab_list%></ul><div class=\"tab-content\" <% if (elt.id) { %> data-tabset=\"<%= elt.id %>\"<% } %>><%=children%></div>',\r\n      'getElement': function (el) {\r\n        return $(el).parent().get(0);\r\n      },\r\n      'onBeforeRender': function (data, node) {\r\n        // Generate the initial 'tabs' from the children\r\n        var parentID = langx.escapeHTML(node.id ? node.id + \"-\" : \"\")\r\n        var tab_list = '';\r\n        util.each(node.children, function (child, idx) {\r\n          var title = langx.escapeHTML(child.title || ('Item ' + (idx+1)));\r\n          var title_escaped = title.replace(\" \",\"_\");\r\n          tab_list += '<li class=\"nav-item' +\r\n            ((idx === 0) ? ' active' : '') + '\">' +\r\n            '<a href=\"#'+ parentID + title_escaped +'\" class=\"nav-link\"' +\r\n            ' data-tab=\"' + parentID + title_escaped + '\"' +\r\n            ' data-toggle=\"tab\">' + title +\r\n            '</a></li>';\r\n        });\r\n        data.tab_list = tab_list;\r\n        return data;\r\n      },\r\n      'onInsert': function(evt, node){\r\n        $(\"#\"+node.id+\">li.nav-item\").on(\"click\", function(e){\r\n          e.preventDefault();\r\n          $(node.el).find(\"div[data-tabset='\"+node.id+\"']>div.tab-pane.active\").each(function(){\r\n            $(this).removeClass(\"active\");\r\n          })\r\n          var tab_id = $(this).find('a').attr('data-tab');\r\n          $(\"#\"+tab_id).addClass(\"active\");\r\n        });\r\n      }\r\n    },\r\n    'tab':{\r\n      'template': '<div class=\"tab-pane' +\r\n      '<% if (elt.htmlClass) { %> <%= elt.htmlClass %> <% } %>' +\r\n          //Set the first tab as active\r\n      '<% if (node.childPos === 0) { %> active<% } %>' +\r\n      '\"' + //Finish end quote of class tag\r\n      '<% if (node.title) { %> id=\"<%= node.parentNode.id %>-<%= node.title.replace(\" \",\"_\") %>\"<% } %>' +\r\n      '><%= children %></div>'\r\n    },\r\n    'selectfieldset': {\r\n      'template': '<fieldset class=\"tab-container <%= elt.htmlClass?elt.htmlClass:\"\" %>\">' +\r\n        '<% if (node.legend) { %><legend role=\"treeitem\" aria-expanded=\"false\"><%= node.legend %></legend><% } %>' +\r\n        '<% if (node.formElement.key) { %><input type=\"hidden\" id=\"<%= node.id %>\" name=\"<%= node.name %>\" value=\"<%= escape(value) %>\" /><% } else { %>' +\r\n          '<a id=\"<%= node.id %>\"></a><% } %>' +\r\n        '<div class=\"tabbable\">' +\r\n          '<div class=\"form-group<%= node.formElement.hideMenu ? \" hide\" : \"\" %>\">' +\r\n            '<% if (!elt.notitle) { %><label for=\"<%= node.id %>\"><%= node.title ? node.title : node.name %></label><% } %>' +\r\n            '<div class=\"controls\"><%= tabs %></div>' +\r\n          '</div>' +\r\n          '<div class=\"tab-content\">' +\r\n            '<%= children %>' +\r\n          '</div>' +\r\n        '</div>' +\r\n        '</fieldset>',\r\n      'inputfield': true,\r\n      'getElement': function (el) {\r\n        return $(el).parent().get(0);\r\n      },\r\n      'childTemplate': function (inner) {\r\n        return '<div data-idx=\"<%= node.childPos %>\" class=\"tab-pane' +\r\n          '<% if (node.active) { %> active<% } %>\">' +\r\n          inner +\r\n          '</div>';\r\n      },\r\n      'onBeforeRender': function (data, node) {\r\n        // Before rendering, this function ensures that:\r\n        // 1. direct children have IDs (used to show/hide the tabs contents)\r\n        // 2. the tab to active is flagged accordingly. The active tab is\r\n        // the first one, except if form values are available, in which case\r\n        // it's the first tab for which there is some value available (or back\r\n        // to the first one if there are none)\r\n        // 3. the HTML of the select field used to select tabs is exposed in the\r\n        // HTML template data as \"tabs\"\r\n\r\n        var children = null;\r\n        var choices = [];\r\n        if (node.schemaElement) {\r\n          choices = node.schemaElement['enum'] || [];\r\n        }\r\n        if (node.options) {\r\n          children = langx.map(node.options, function (option, idx) {\r\n            var child = node.children[idx];\r\n            child.childPos = idx; // When nested the childPos is always 0.\r\n            if (option instanceof Object) {\r\n              option = langx.extend({ node: child }, option);\r\n              option.title = option.title ||\r\n                child.legend ||\r\n                child.title ||\r\n                ('Option ' + (child.childPos+1));\r\n              option.value = util.isSet(option.value) ? option.value :\r\n                util.isSet(choices[idx]) ? choices[idx] : idx;\r\n              return option;\r\n            }\r\n            else {\r\n              return {\r\n                title: option,\r\n                value: util.isSet(choices[child.childPos]) ?\r\n                  choices[child.childPos] :\r\n                  child.childPos,\r\n                node: child\r\n              };\r\n            }\r\n          });\r\n        }\r\n        else {\r\n          children = langx.map(node.children, function (child, idx) {\r\n            child.childPos = idx; // When nested the childPos is always 0.\r\n            return {\r\n              title: child.legend || child.title || ('Option ' + (child.childPos+1)),\r\n              value: choices[child.childPos] || child.childPos,\r\n              node: child\r\n            };\r\n          });\r\n        }\r\n\r\n        // Reset each children to inactive so that they are not shown on insert\r\n        // The active one will then be shown later one. This is useful when sorting\r\n        // arrays with selectfieldset, otherwise both fields could be active at the\r\n        // same time.\r\n        util.each(children, function (child, idx) {\r\n          child.node.active = false\r\n        });\r\n\r\n        var activeChild = null;\r\n        if (data.value) {\r\n          activeChild = langx.find(children, function (child) {\r\n            return (child.value === node.value);\r\n          });\r\n        }\r\n        if (!activeChild) {\r\n          activeChild = langx.find(children, function (child) {\r\n            return child.node.hasNonDefaultValue();\r\n          });\r\n        }\r\n        if (!activeChild) {\r\n          activeChild = children[0];\r\n        }\r\n        activeChild.node.active = true;\r\n        data.value = activeChild.value;\r\n\r\n        var elt = node.formElement;\r\n        var tabs = '<select class=\"nav form-control\"' +\r\n          (node.disabled ? ' disabled' : '') +\r\n          '>';\r\n        util.each(children, function (child, idx) {\r\n          tabs += '<option data-idx=\"' + idx + '\" value=\"' + child.value + '\"' +\r\n            (child.node.active ? ' selected=\"selected\" class=\"active\"' : '') +\r\n            '>' +\r\n            langx.escapeHTML(child.title) +\r\n            '</option>';\r\n        });\r\n        tabs += '</select>';\r\n\r\n        data.tabs = tabs;\r\n        return data;\r\n      },\r\n      'onInsert': function (evt, node) {\r\n        $(node.el).find('select.nav').first().on('change', function (evt) {\r\n          var $option = $(this).find('option:selected');\r\n          $(node.el).find('input[type=\"hidden\"]').first().val($option.attr('value'));\r\n        });\r\n      }\r\n    },\r\n    'optionfieldset': {\r\n      'template': '<div' +\r\n        '<% if (node.id) { %> id=\"<%= node.id %>\"<% } %>' +\r\n        '>' +\r\n        '<%= children %>' +\r\n        '</div>'\r\n    },\r\n    'section': {\r\n      'template': '<div' +\r\n        '<% if (elt.htmlClass) { %> class=\"<%= elt.htmlClass %>\"<% } %>' +\r\n        '<% if (node.id) { %> id=\"<%= node.id %>\"<% } %>' +\r\n        '><%= children %></div>'\r\n    },\r\n\r\n    /**\r\n     * A \"questions\" field renders a series of question fields and binds the\r\n     * result to the value of a schema key.\r\n     */\r\n    'questions': {\r\n      'template': '<div>' +\r\n        '<input type=\"hidden\" id=\"<%= node.id %>\" name=\"<%= node.name %>\" value=\"<%= escape(value) %>\" />' +\r\n        '<%= children %>' +\r\n        '</div>',\r\n      'fieldtemplate': true,\r\n      'inputfield': true,\r\n      'getElement': function (el) {\r\n        return $(el).parent().get(0);\r\n      },\r\n      'onInsert': function (evt, node) {\r\n        if (!node.children || (node.children.length === 0)) return;\r\n        util.each(node.children, function (child) {\r\n          $(child.el).hide();\r\n        });\r\n        $(node.children[0].el).show();\r\n      }\r\n    },\r\n\r\n    /**\r\n     * A \"question\" field lets user choose a response among possible choices.\r\n     * The field is not associated with any schema key. A question should be\r\n     * part of a \"questions\" field that binds a series of questions to a\r\n     * schema key.\r\n     */\r\n    'question': {\r\n      'template': '<div id=\"<%= node.id %>\"><% _.forEach(node.options, function(key, val) { %><label class=\"<%= (node.formElement.optionsType === \"radiobuttons\") ? \"btn btn-default\" : \"\" %><%= ((key instanceof Object && key.htmlClass) ? \" \" + key.htmlClass : \"\") %>\"><input type=\"radio\" <% if (node.formElement.optionsType === \"radiobuttons\") { %> style=\"position:absolute;left:-9999px;\" <% } %>name=\"<%= node.id %>\" value=\"<%= val %>\"<%= (node.disabled? \" disabled\" : \"\")%>/><span><%= (key instanceof Object ? key.title : key) %></span></label> <% }); %></div>',\r\n      'fieldtemplate': true,\r\n      'onInsert': function (evt, node) {\r\n        var activeClass = 'active';\r\n        var elt = node.formElement || {};\r\n        if (elt.activeClass) {\r\n          activeClass += ' ' + elt.activeClass;\r\n        }\r\n\r\n        // Bind to change events on radio buttons\r\n        $(node.el).find('input[type=\"radio\"]').on('change', function (evt) {\r\n          var questionNode = null;\r\n          var option = node.options[$(this).val()];\r\n          if (!node.parentNode || !node.parentNode.el) return;\r\n\r\n          $(this).parent().parent().find('label').removeClass(activeClass);\r\n          $(this).parent().addClass(activeClass);\r\n          $(node.el).nextAll().hide();\r\n          $(node.el).nextAll().find('input[type=\"radio\"]').prop('checked', false);\r\n\r\n          // Execute possible actions (set key value, form submission, open link,\r\n          // move on to next question)\r\n          if (option.value) {\r\n            // Set the key of the 'Questions' parent\r\n            $(node.parentNode.el).find('input[type=\"hidden\"]').val(option.value);\r\n          }\r\n          if (option.next) {\r\n            questionNode = langx.find(node.parentNode.children, function (child) {\r\n              return (child.formElement && (child.formElement.qid === option.next));\r\n            });\r\n            $(questionNode.el).show();\r\n            $(questionNode.el).nextAll().hide();\r\n            $(questionNode.el).nextAll().find('input[type=\"radio\"]').prop('checked', false);\r\n          }\r\n          if (option.href) {\r\n            if (option.target) {\r\n              window.open(option.href, option.target);\r\n            }\r\n            else {\r\n              window.location = option.href;\r\n            }\r\n          }\r\n          if (option.submit) {\r\n            setTimeout(function () {\r\n              node.ownerTree.submit();\r\n            }, 0);\r\n          }\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  return jsonform.elementTypes;\r\n});\r\n"]}