/**
 * skylark-jsonform - A version of jsonform that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-jsonform/
 * @license MIT
 */
define(["skylark-langx","skylark-jquery","./jsonform","./util"],function(e,t,n,a){var l='<div class="_jsonform-preview"><% if (value.type=="image") { %><img class="jsonform-preview" id="jsonformpreview-<%= id %>" src="<%= value.url %>" /><% } else { %><a href="<%= value.url %>"><%= value.name %></a> (<%= Math.ceil(value.size/1024) %>kB)<% } %></div><a href="#" class="btn btn-default _jsonform-delete"><i class="glyphicon glyphicon-remove" title="Remove"></i></a> ',i=function(e){return{template:'<input type="'+e+'" class=\'form-control<%= (fieldHtmlClass ? " " + fieldHtmlClass : "") %>\'name="<%= node.name %>" value="<%= escape(value) %>" id="<%= id %>" aria-label="<%= node.title ? escape(node.title) : node.name %>"<%= (node.disabled? " disabled" : "")%><%= (node.readOnly ? " readonly=\'readonly\'" : "") %><%= (node.schemaElement && (node.schemaElement.step > 0 || node.schemaElement.step == "any") ? " step=\'" + node.schemaElement.step + "\'" : "") %><%= (node.schemaElement && node.schemaElement.minLength ? " minlength=\'" + node.schemaElement.minLength + "\'" : "") %><%= (node.schemaElement && node.schemaElement.maxLength ? " maxlength=\'" + node.schemaElement.maxLength + "\'" : "") %><%= (node.schemaElement && node.schemaElement.required && (node.schemaElement.type !== "boolean") ? " required=\'required\'" : "") %><%= (node.placeholder? " placeholder=" + \'"\' + escape(node.placeholder) + \'"\' : "")%> />',fieldtemplate:!0,inputfield:!0}};return n.elementTypes={none:{template:""},root:{template:"<div><%= children %></div>"},text:i("text"),password:i("password"),date:i("date"),datetime:i("datetime"),"datetime-local":i("datetime-local"),email:i("email"),month:i("month"),number:i("number"),search:i("search"),tel:i("tel"),time:i("time"),url:i("url"),week:i("week"),range:{template:'<div class="range"><input type="range" <%= (fieldHtmlClass ? "class=\'" + fieldHtmlClass + "\' " : "") %>name="<%= node.name %>" value="<%= escape(value) %>" id="<%= id %>" aria-label="<%= node.title ? escape(node.title) : node.name %>"<%= (node.disabled? " disabled" : "")%> min=<%= range.min %> max=<%= range.max %> step=<%= range.step %><%= (node.schemaElement && node.schemaElement.required ? " required=\'required\'" : "") %> /><% if (range.indicator) { %><span class="range-value" rel="<%= id %>"><%= escape(value) %></span><% } %></div>',fieldtemplate:!0,inputfield:!0,onInput:function(e,t){const n=document.querySelector('span.range-value[rel="'+t.id+'"]');n&&(n.innerText=e.target.value)},onBeforeRender:function(e,t){e.range={min:1,max:100,step:1,indicator:!1},t&&t.schemaElement&&(t.formElement&&t.formElement.step&&(e.range.step=t.formElement.step),t.formElement&&t.formElement.indicator&&(e.range.indicator=t.formElement.indicator),void 0!==t.schemaElement.minimum&&(t.schemaElement.exclusiveMinimum?e.range.min=t.schemaElement.minimum+e.range.step:e.range.min=t.schemaElement.minimum),void 0!==t.schemaElement.maximum&&(t.schemaElement.exclusiveMaximum?e.range.max=t.schemaElement.maximum-e.range.step:e.range.max=t.schemaElement.maximum))}},color:{template:'<input type="text" <%= (fieldHtmlClass ? "class=\'" + fieldHtmlClass + "\' " : "") %>name="<%= node.name %>" value="<%= escape(value) %>" id="<%= id %>" aria-label="<%= node.title ? escape(node.title) : node.name %>"<%= (node.disabled? " disabled" : "")%><%= (node.schemaElement && node.schemaElement.required ? " required=\'required\'" : "") %> />',fieldtemplate:!0,inputfield:!0,onInsert:function(e,n){t(n.el).find("#"+a.escapeSelector(n.id)).spectrum({preferredFormat:"hex",showInput:!0})}},textarea:{template:'<textarea id="<%= id %>" name="<%= node.name %>" <%= (fieldHtmlClass ? "class=\'" + fieldHtmlClass + "\' " : "") %>style="height:<%= elt.height || "150px" %>;width:<%= elt.width || "100%" %>;" aria-label="<%= node.title ? escape(node.title) : node.name %>"<%= (node.disabled? " disabled" : "")%><%= (node.readOnly ? " readonly=\'readonly\'" : "") %><%= (node.schemaElement && node.schemaElement.minLength ? " minlength=\'" + node.schemaElement.minLength + "\'" : "") %><%= (node.schemaElement && node.schemaElement.maxLength ? " maxlength=\'" + node.schemaElement.maxLength + "\'" : "") %><%= (node.schemaElement && node.schemaElement.required ? " required=\'required\'" : "") %><%= (node.placeholder? " placeholder=" + \'"\' + escape(node.placeholder) + \'"\' : "")%>><%= value %></textarea>',fieldtemplate:!0,inputfield:!0},wysihtml5:{template:'<textarea id="<%= id %>" name="<%= node.name %>" style="height:<%= elt.height || "300px" %>;width:<%= elt.width || "100%" %>;" aria-label="<%= node.title ? escape(node.title) : node.name %>"<%= (fieldHtmlClass ? "class=\'" + fieldHtmlClass + "\' " : "") %><%= (node.disabled? " disabled" : "")%><%= (node.readOnly ? " readonly=\'readonly\'" : "") %><%= (node.schemaElement && node.schemaElement.minLength ? " minlength=\'" + node.schemaElement.minLength + "\'" : "") %><%= (node.schemaElement && node.schemaElement.maxLength ? " maxlength=\'" + node.schemaElement.maxLength + "\'" : "") %><%= (node.schemaElement && node.schemaElement.required ? " required=\'required\'" : "") %><%= (node.placeholder? " placeholder=" + \'"\' + escape(node.placeholder) + \'"\' : "")%>><%= value %></textarea>',fieldtemplate:!0,inputfield:!0,onInsert:function(e,n){var l=function(){t(n.el).data("wysihtml5")||(t(n.el).data("wysihtml5_loaded",!0),t(n.el).find("#"+a.escapeSelector(n.id)).wysihtml5({html:!0,link:!0,"font-styles":!0,image:!1,events:{load:function(){t(this.textareaElement).removeAttr("required")}}}))};if(window.jsonform_wysihtml5_setup)window.jsonform_wysihtml5_setup(l);else var i=window.setInterval(function(){window.wysihtml5&&(window.clearInterval(i),l())},1e3)}},ace:{template:'<div id="<%= id %>" style="position:relative;height:<%= elt.height || "300px" %>;"><div id="<%= id %>__ace" style="width:<%= elt.width || "100%" %>;height:<%= elt.height || "300px" %>;"></div><input type="hidden" name="<%= node.name %>" id="<%= id %>__hidden" value="<%= escape(value) %>"/></div>',fieldtemplate:!0,inputfield:!0,onInsert:function(n,l){var i=function(){var n=l.formElement||{},i=window.ace.edit(t(l.el).find("#"+a.escapeSelector(l.id)+"__ace").get(0)),d="#"+a.escapeSelector(l.id)+"__hidden";i.getSession().setNewLineMode("unix"),i.renderer.setShowPrintMargin(!1),i.setTheme("ace/theme/"+(n.aceTheme||"twilight")),n.aceMode&&i.getSession().setMode("ace/mode/"+n.aceMode),i.getSession().setTabSize(2),i.getSession().setValue(l.value||"");var s=e.debounce(function(){t(l.el).find(d).val(i.getSession().getValue()),t(l.el).find(d).change()},600);i.getSession().on("change",s),i.on("blur",function(){t(l.el).find(d).change(),t(l.el).find(d).trigger("blur")}),i.on("focus",function(){t(l.el).find(d).trigger("focus")})};if(window.jsonform_ace_setup)window.jsonform_ace_setup(i);else var d=window.setInterval(function(){window.ace&&(window.clearInterval(d),i())},1e3)}},checkbox:{template:'<div class="checkbox"><label><input type="checkbox" id="<%= id %>" <%= (fieldHtmlClass ? " class=\'" + fieldHtmlClass + "\'": "") %>name="<%= node.name %>" value="1" <% if (value) {%>checked<% } %><%= (node.disabled? " disabled" : "")%><%= (node.schemaElement && node.schemaElement.required && (node.schemaElement.type !== "boolean") ? " required=\'required\'" : "") %> /><%= node.inlinetitle || "" %></label></div>',fieldtemplate:!0,inputfield:!0,getElement:function(e){return t(e).parent().get(0)}},file:{template:'<input class="input-file" id="<%= id %>" name="<%= node.name %>" type="file" <%= (node.schemaElement && node.schemaElement.required ? " required=\'required\'" : "") %><%= (node.formElement && node.formElement.accept ? (" accept=\'" + node.formElement.accept + "\'") : "") %>/>',fieldtemplate:!0,inputfield:!0},"file-hosted-public":{template:"<span><% if (value && (value.type||value.url)) { %>"+l+'<% } %><input class="input-file" id="_transloadit_<%= id %>" type="file" name="<%= transloaditname %>" /><input data-transloadit-name="_transloadit_<%= transloaditname %>" type="hidden" id="<%= id %>" name="<%= node.name %>" value=\'<%= escape(JSON.stringify(node.value)) %>\' /></span>',fieldtemplate:!0,inputfield:!0,getElement:function(e){return t(e).parent().get(0)},onBeforeRender:function(e,t){t.ownerTree._transloadit_generic_public_index?t.ownerTree._transloadit_generic_public_index++:t.ownerTree._transloadit_generic_public_index=1,e.transloaditname="_transloadit_jsonform_genericupload_public_"+t.ownerTree._transloadit_generic_public_index,t.ownerTree._transloadit_generic_elts||(t.ownerTree._transloadit_generic_elts={}),t.ownerTree._transloadit_generic_elts[e.transloaditname]=t},onChange:function(n,l){if(l.ownerTree._transloadit_bound)return!1;l.ownerTree._transloadit_bound=!0;var i=t(l.ownerTree.domRoot);i.transloadit({autoSubmit:!1,wait:!0,onSuccess:function(t){var n=e.values(t.results);n=e.flatten(n),a.each(n,function(t){var n=l.ownerTree._transloadit_generic_elts[t.field].id,d=i.find("#"+a.escapeSelector(n)),s=e.filter(e.keys(t.meta),function(e){return!!a.isSet(t.meta[e])});t.meta=e.pick(t.meta,s),d.val(JSON.stringify(t))}),l.ownerTree._transloadit_bound=!1,i.unbind("submit.transloadit"),e.defer(function(){l.ownerTree.submit()},10)},onError:function(e){console.log("assembly error",e)}})},onInsert:function(e,n){t(n.el).find("a._jsonform-delete").on("click",function(e){return t(n.el).find("._jsonform-preview").remove(),t(n.el).find("a._jsonform-delete").remove(),t(n.el).find("#"+a.escapeSelector(n.id)).val(""),e.preventDefault(),!1})},onSubmit:function(e,t){return!t.ownerTree._transloadit_bound}},"file-transloadit":{template:"<span><% if (value && (value.type||value.url)) { %>"+l+'<% } %><input class="input-file" id="_transloadit_<%= id %>" type="file" name="_transloadit_<%= node.name %>" /><input type="hidden" id="<%= id %>" name="<%= node.name %>" value=\'<%= escape(JSON.stringify(node.value)) %>\' /></span>',fieldtemplate:!0,inputfield:!0,getElement:function(e){return t(e).parent().get(0)},onChange:function(n,l){if(l.ownerTree._transloadit_bound)return!1;l.ownerTree._transloadit_bound=!0;var i=t(l.ownerTree.domRoot);i.transloadit({autoSubmit:!1,wait:!0,onSuccess:function(t){var n=e.values(t.results);n=e.flatten(n),a.each(n,function(t){var n=i.find('input[name="'+t.field.replace(/^_transloadit_/,"")+'"]'),l=e.filter(e.keys(t.meta),function(e){return!!a.isSet(t.meta[e])});t.meta=e.pick(t.meta,l),n.val(JSON.stringify(t))}),l.ownerTree._transloadit_bound=!1,i.unbind("submit.transloadit"),e.defer(function(){l.ownerTree.submit()},10)},onError:function(e){console.log("assembly error",e)}})},onInsert:function(e,n){t(n.el).find("a._jsonform-delete").on("click",function(e){return t(n.el).find("._jsonform-preview").remove(),t(n.el).find("a._jsonform-delete").remove(),t(n.el).find("#"+a.escapeSelector(n.id)).val(""),e.preventDefault(),!1})},onSubmit:function(e,t){return!t.ownerTree._transloadit_bound}},select:{template:'<select name="<%= node.name %>" id="<%= id %>"class=\'form-control<%= (fieldHtmlClass ? " " + fieldHtmlClass : "") %>\'<%= (node.schemaElement && node.schemaElement.disabled? " disabled" : "")%><%= (node.schemaElement && node.schemaElement.required ? " required=\'required\'" : "") %>> <% _.forEach(node.options, function(key, val) { if(key instanceof Object) { if (value === key.value) { %> <option selected value="<%= key.value %>"><%= key.title %></option> <% } else { %> <option value="<%= key.value %>"><%= key.title %></option> <% }} else { if (value === key) { %> <option selected value="<%= key %>"><%= key %></option> <% } else { %><option value="<%= key %>"><%= key %></option> <% }}}); %> </select>',fieldtemplate:!0,inputfield:!0},imageselect:{template:'<div><input type="hidden" name="<%= node.name %>" id="<%= node.id %>" value="<%= value %>" /><div class="dropdown"><a class="btn<% if (buttonClass && node.value) { %> <%= buttonClass %><% } else { %> btn-default<% } %>" data-toggle="dropdown" href="#"<% if (node.value) { %> style="max-width:<%= width %>px;max-height:<%= height %>px"<% } %>><% if (node.value) { %><img src="<% if (!node.value.match(/^https?:/)) { %><%= prefix %><% } %><%= node.value %><%= suffix %>" alt="" /><% } else { %><%= buttonTitle %><% } %></a><div class="dropdown-menu navbar" id="<%= node.id %>_dropdown"><div><% _.forEach(node.options, function(key, idx) { if ((idx > 0) && ((idx % columns) === 0)) { %></div><div><% } %><a class="btn<% if (buttonClass) { %> <%= buttonClass %><% } else { %> btn-default<% } %>" style="max-width:<%= width %>px;max-height:<%= height %>px"><% if (key instanceof Object) { %><img src="<% if (!key.value.match(/^https?:/)) { %><%= prefix %><% } %><%= key.value %><%= suffix %>" alt="<%= key.title %>" /></a><% } else { %><img src="<% if (!key.match(/^https?:/)) { %><%= prefix %><% } %><%= key %><%= suffix %>" alt="" /><% } %></a> <% }); %></div><div class="pagination-right"><a class="btn btn-default">Reset</a></div></div></div></div>',fieldtemplate:!0,inputfield:!0,onBeforeRender:function(e,t){var n=t.formElement||{},a=null,l=n.imageSelectorColumns||5;e.buttonTitle=n.imageSelectorTitle||"Select...",e.prefix=n.imagePrefix||"",e.suffix=n.imageSuffix||"",e.width=n.imageWidth||32,e.height=n.imageHeight||32,e.buttonClass=n.imageButtonClass||!1,t.options.length>l?(a=Math.ceil(t.options.length/l),e.columns=Math.ceil(t.options.length/a)):e.columns=l},getElement:function(e){return t(e).parent().get(0)},onInsert:function(e,n){t(n.el).on("click",".dropdown-menu a",function(e){e.preventDefault(),e.stopPropagation();var a=("img"===e.target.nodeName.toLowerCase()?t(e.target):t(e.target).find("img")).attr("src"),l=n.formElement||{},i=l.imagePrefix||"",d=l.imageSuffix||"",s=l.imageWidth||32,o=l.imageHeight||32;a?(0===a.indexOf(i)&&(a=a.substring(i.length)),a=a.substring(0,a.length-d.length),t(n.el).find("input").attr("value",a),t(n.el).find('a[data-toggle="dropdown"]').addClass(l.imageButtonClass).attr("style","max-width:"+s+"px;max-height:"+o+"px").html('<img src="'+(a.match(/^https?:/)?"":i)+a+d+'" alt="" />')):(t(n.el).find("input").attr("value",""),t(n.el).find('a[data-toggle="dropdown"]').removeClass(l.imageButtonClass).removeAttr("style").html(l.imageSelectorTitle||"Select..."))})}},iconselect:{template:'<div><input type="hidden" name="<%= node.name %>" id="<%= node.id %>" value="<%= value %>" /><div class="dropdown"><a class="btn<% if (buttonClass && node.value) { %> <%= buttonClass %><% } %>" data-toggle="dropdown" href="#"<% if (node.value) { %> style="max-width:<%= width %>px;max-height:<%= height %>px"<% } %>><% if (node.value) { %><i class="icon-<%= node.value %>" /><% } else { %><%= buttonTitle %><% } %></a><div class="dropdown-menu navbar" id="<%= node.id %>_dropdown"><div><% _.forEach(node.options, function(key, idx) { if ((idx > 0) && ((idx % columns) === 0)) { %></div><div><% } %><a class="btn<% if (buttonClass) { %> <%= buttonClass %><% } %>" ><% if (key instanceof Object) { %><i class="icon-<%= key.value %>" alt="<%= key.title %>" /></a><% } else { %><i class="icon-<%= key %>" alt="" /><% } %></a> <% }); %></div><div class="pagination-right"><a class="btn">Reset</a></div></div></div></div>',fieldtemplate:!0,inputfield:!0,onBeforeRender:function(e,t){var n=t.formElement||{},a=null,l=n.imageSelectorColumns||5;e.buttonTitle=n.imageSelectorTitle||"Select...",e.buttonClass=n.imageButtonClass||!1,t.options.length>l?(a=Math.ceil(t.options.length/l),e.columns=Math.ceil(t.options.length/a)):e.columns=l},getElement:function(e){return t(e).parent().get(0)},onInsert:function(e,n){t(n.el).on("click",".dropdown-menu a",function(e){e.preventDefault(),e.stopPropagation();var a=("i"===e.target.nodeName.toLowerCase()?t(e.target):t(e.target).find("i")).attr("class"),l=n.formElement||{};a?(a=a,t(n.el).find("input").attr("value",a),t(n.el).find('a[data-toggle="dropdown"]').addClass(l.imageButtonClass).html('<i class="'+a+'" alt="" />')):(t(n.el).find("input").attr("value",""),t(n.el).find('a[data-toggle="dropdown"]').removeClass(l.imageButtonClass).html(l.imageSelectorTitle||"Select..."))})}},radios:{template:'<div id="<%= node.id %>"><% _.forEach(node.options, function(key, val) { %><div class="radio"><label><input<%= (fieldHtmlClass ? " class=\'" + fieldHtmlClass + "\'": "") %> type="radio" <% if (((key instanceof Object) && (value === key.value)) || (value === key)) { %> checked="checked" <% } %> name="<%= node.name %>" value="<%= (key instanceof Object ? key.value : key) %>"<%= (node.disabled? " disabled" : "")%><%= (node.schemaElement && node.schemaElement.required ? " required=\'required\'" : "") %>/><%= (key instanceof Object ? key.title : key) %></label></div> <% }); %></div>',fieldtemplate:!0,inputfield:!0},radiobuttons:{template:'<div id="<%= node.id %>"><% _.forEach(node.options, function(key, val) { %><label class="btn btn-default <% if (((key instanceof Object) && (value === key.value)) || (value === key)) { %>active btn-success<% } %>"><input<%= (fieldHtmlClass ? " class=\'" + fieldHtmlClass + "\'": "") %> type="radio" style="position:absolute;left:-9999px;" <% if (((key instanceof Object) && (value === key.value)) || (value === key)) { %> checked="checked" <% } %> name="<%= node.name %>" value="<%= (key instanceof Object ? key.value : key) %>" /><span><%= (key instanceof Object ? key.title : key) %></span></label> <% }); %></div>',fieldtemplate:!0,inputfield:!0,onInsert:function(e,n){var a="active",l=n.formElement||{};l.activeClass&&(a+=" "+l.activeClass),t(n.el).find("label").on("click",function(){t(this).parent().find("label").removeClass(a),t(this).addClass(a)})}},checkboxes:{template:"<div><%= choiceshtml %></div>",fieldtemplate:!0,inputfield:!0,onBeforeRender:function(t,n){var l=null,i=null;n&&n.schemaElement&&(l=n.schemaElement.items?n.schemaElement.items.enum||n.schemaElement.items[0].enum:n.schemaElement.enum)&&(i="",a.each(l,function(t,l){i+=e.template('<div class="checkbox"><label><input type="checkbox" <% if (value) { %> checked="checked" <% } %> name="<%= name %>" value="1"<%= (node.disabled? " disabled" : "")%>/><%= title %></label></div>',a.fieldTemplateSettings)({name:n.key+"["+l+"]",value:e.contains(n.value,t),title:a.hasOwnProperty(n.formElement.titleMap,t)?n.formElement.titleMap[t]:t,node:n})}),t.choiceshtml=i)}},array:{template:'<div id="<%= id %>"><ul class="_jsonform-array-ul" style="list-style-type:none;"><%= children %></ul><span class="_jsonform-array-buttons"><a href="#" class="btn btn-default _jsonform-array-addmore"><i class="glyphicon glyphicon-plus-sign" title="Add new"></i></a> <a href="#" class="btn btn-default _jsonform-array-deletelast"><i class="glyphicon glyphicon-minus-sign" title="Delete last"></i></a></span></div>',fieldtemplate:!0,array:!0,childTemplate:function(e,n){return t("").sortable?'<li data-idx="<%= node.childPos %>">'+(n?'<span class="draggable line"><i class="glyphicon glyphicon-list" title="Move item"></i></span>':"")+e+"</li>":'<li data-idx="<%= node.childPos %>">'+e+"</li>"},onInsert:function(e,n){var l=t(n.el).find("#"+a.escapeSelector(n.id)),i=n.getArrayBoundaries();t("> span > a._jsonform-array-addmore",l).click(function(e){e.preventDefault(),e.stopPropagation();var a=n.children.length;if(i.maxItems>=0&&(n.children.length>i.maxItems-2&&l.find("> span > a._jsonform-array-addmore").addClass("disabled"),n.children.length>i.maxItems-1))return!1;n.insertArrayItem(a,t("> ul",l).get(0)),(i.minItems<=0||i.minItems>0&&n.children.length>i.minItems-1)&&l.find("> span > a._jsonform-array-deletelast").removeClass("disabled")});var d=t("> ul > li",l).length;if(i.minItems>0&&d<i.minItems)for(var s=0;s<i.minItems-1&&l.find("> ul > li").length<i.minItems;s++)n.insertArrayItem(d,l.find("> ul").get(0));i.minItems>0&&n.children.length<=i.minItems&&l.find("> span > a._jsonform-array-deletelast").addClass("disabled"),t("> span > a._jsonform-array-deletelast",l).click(function(e){var t=n.children.length-1;if(e.preventDefault(),e.stopPropagation(),i.minItems>0){if(n.children.length<i.minItems+2&&l.find("> span > a._jsonform-array-deletelast").addClass("disabled"),n.children.length<=i.minItems)return!1}else 1===n.children.length&&l.find("> span > a._jsonform-array-deletelast").addClass("disabled");n.deleteArrayItem(t),i.maxItems>=0&&t<=i.maxItems-1&&l.find("> span > a._jsonform-array-addmore").removeClass("disabled")}),a.isSet(n.formElement.draggable)&&!n.formElement.draggable||t(n.el).sortable&&(t("> ul",l).sortable(),t("> ul",l).bind("sortstop",function(e,a){!function(e,a){if(e!==a){var i=e<a?1:-1,d=0,s=t("> ul",l);for(d=e;d!==a;d+=i)n.children[d].switchValuesWith(n.children[d+i]),n.children[d].render(s.get(0)),n.children[d+i].render(s.get(0));var o=t(n.children[e].el),r=t(n.children[a].el);o.detach(),r.detach(),e<a?(0===e?s.prepend(o):t(n.children[e-1].el).after(o),t(n.children[a-1].el).after(r)):(0===a?s.prepend(r):t(n.children[a-1].el).after(r),t(n.children[e-1].el).after(o))}}(t(a.item).data("idx"),t(a.item).index())}))}},tabarray:{template:'<div id="<%= id %>"><div class="tabbable tabs-left"><ul class="nav nav-tabs"><%= tabs %></ul><div class="tab-content"><%= children %></div></div><a href="#" class="btn btn-default _jsonform-array-addmore"><i class="glyphicon glyphicon-plus-sign" title="Add new"></i></a> <a href="#" class="btn btn-default _jsonform-array-deleteitem"><i class="glyphicon glyphicon-minus-sign" title="Delete item"></i></a></div>',fieldtemplate:!0,array:!0,childTemplate:function(e){return'<div data-idx="<%= node.childPos %>" class="tab-pane">'+e+"</div>"},onBeforeRender:function(t,n){var l="";a.each(n.children,function(t,n){var a=t.legend||t.title||"Item "+(n+1);l+='<li data-idx="'+n+'"'+(0===n?' class="active"':"")+'><a class="draggable tab" data-toggle="tab" rel="'+escape(a)+'">'+e.escapeHTML(a)+"</a></li>"}),t.tabs=l},onInsert:function(n,l){var i=t(l.el).find("#"+a.escapeSelector(l.id)),d=l.getArrayBoundaries(),s=function(n){var d="",s=!1;void 0===n&&((n=t("> .tabbable > .nav-tabs .active",i).data("idx"))?n=parseInt(n,10):(s=!0,n=0)),n>=l.children.length&&(n=l.children.length-1),a.each(l.children,function(n,a){t('> .tabbable > .tab-content > [data-idx="'+a+'"] > fieldset > legend',i).html(n.legend);var l=n.legend||n.title||"Item "+(a+1);d+='<li data-idx="'+a+'"><a class="draggable tab" data-toggle="tab" rel="'+escape(l)+'">'+e.escapeHTML(l)+"</a></li>"}),t("> .tabbable > .nav-tabs",i).html(d),s&&t('> .tabbable > .nav-tabs [data-idx="0"]',i).addClass("active"),t('> .tabbable > .nav-tabs [data-toggle="tab"]',i).eq(n).click()};if(t("> a._jsonform-array-deleteitem",i).click(function(e){var n=Number(t("> .tabbable > .nav-tabs .active",i).data("idx"));if(e.preventDefault(),e.stopPropagation(),d.minItems>0&&(l.children.length<d.minItems+1&&i.find("> a._jsonform-array-deleteitem").addClass("disabled"),l.children.length<=d.minItems))return!1;l.deleteArrayItem(n),s(),(l.children.length<d.minItems+1||0===l.children.length)&&i.find("> a._jsonform-array-deleteitem").addClass("disabled"),d.maxItems>=0&&l.children.length<=d.maxItems&&i.find("> a._jsonform-array-addmore").removeClass("disabled")}),t("> a._jsonform-array-addmore",i).click(function(e){var n=l.children.length;if(d.maxItems>=0&&(l.children.length>d.maxItems-2&&t("> a._jsonform-array-addmore",i).addClass("disabled"),l.children.length>d.maxItems-1))return!1;e.preventDefault(),e.stopPropagation(),l.insertArrayItem(n,i.find("> .tabbable > .tab-content").get(0)),s(n),(d.minItems<=0||d.minItems>0&&n>d.minItems-1)&&i.find("> a._jsonform-array-deleteitem").removeClass("disabled")}),t(l.el).on("legendUpdated",function(e){s(),e.preventDefault(),e.stopPropagation()}),a.isSet(l.formElement.draggable)&&!l.formElement.draggable||t(l.el).sortable&&(t("> .tabbable > .nav-tabs",i).sortable({containment:l.el,tolerance:"pointer"}),t("> .tabbable > .nav-tabs",i).bind("sortstop",function(e,n){var a=t(n.item).data("idx"),d=t(n.item).index();!function(e,n){if(e!==n){var a=e<n?1:-1,d=0,s=t("> .tabbable > .tab-content",i).get(0);for(d=e;d!==n;d+=a)l.children[d].switchValuesWith(l.children[d+a]),l.children[d].render(s),l.children[d+a].render(s)}}(a,d),s(d)})),d.minItems>=0&&l.children.length<=d.minItems){for(var o=0;o<d.minItems-1;o++)i.find("> a._jsonform-array-addmore").click();i.find("> a._jsonform-array-deleteitem").addClass("disabled"),s()}d.maxItems>=0&&l.children.length>=d.maxItems&&i.find("> a._jsonform-array-addmore").addClass("disabled"),d.minItems>=0&&l.children.length<=d.minItems&&i.find("> a._jsonform-array-deleteitem").addClass("disabled")}},help:{template:'<span class="help-block" style="padding-top:5px"><%= elt.helpvalue %></span>',fieldtemplate:!0},msg:{template:"<%= elt.msg %>"},fieldset:{template:'<fieldset class="form-group jsonform-error-<%= keydash %> <% if (elt.expandable) { %>expandable<% } %> <%= elt.htmlClass?elt.htmlClass:"" %>" <% if (id) { %> id="<%= id %>"<% } %>><% if (node.title || node.legend) { %><legend role="treeitem" aria-expanded="false"><%= node.title || node.legend %></legend><% } %><% if (elt.expandable) { %><div class="form-group"><% } %><%= children %><% if (elt.expandable) { %></div><% } %></fieldset>',onInsert:function(e,n){null!==n.el&&(t(".expandable > div, .expandable > fieldset",n.el).hide(),t(".expandable",n.el).removeClass("expanded"))}},advancedfieldset:{template:'<fieldset<% if (id) { %> id="<%= id %>"<% } %> class="expandable <%= elt.htmlClass?elt.htmlClass:"" %>"><legend role="treeitem" aria-expanded="false"><%= (node.title || node.legend) ? (node.title || node.legend) : "Advanced options" %></legend><div class="form-group"><%= children %></div></fieldset>',onInsert:function(e,n){null!==n.el&&(t(".expandable > div, .expandable > fieldset",n.el).hide(),t(".expandable",n.el).removeClass("expanded"))}},authfieldset:{template:'<fieldset<% if (id) { %> id="<%= id %>"<% } %> class="expandable <%= elt.htmlClass?elt.htmlClass:"" %>"><legend role="treeitem" aria-expanded="false"><%= (node.title || node.legend) ? (node.title || node.legend) : "Authentication settings" %></legend><div class="form-group"><%= children %></div></fieldset>',onInsert:function(e,n){null!==n.el&&(t(".expandable > div, .expandable > fieldset",n.el).hide(),t(".expandable",n.el).removeClass("expanded"))}},submit:{template:'<input type="submit" <% if (id) { %> id="<%= id %>" <% } %> class="btn btn-primary <%= elt.htmlClass?elt.htmlClass:"" %>" value="<%= value || node.title %>"<%= (node.disabled? " disabled" : "")%>/>'},button:{template:' <button type="button" <% if (id) { %> id="<%= id %>" <% } %> class="btn btn-default <%= elt.htmlClass?elt.htmlClass:"" %>"><%= node.title %></button> '},actions:{template:'<div class="<%= elt.htmlClass?elt.htmlClass:"" %>"><%= children %></div>'},hidden:{template:'<input type="hidden" id="<%= id %>" name="<%= node.name %>" value="<%= escape(value) %>" />',inputfield:!0},tabs:{template:'<ul class="nav nav-tabs <%= elt.htmlClass?elt.htmlClass:"" %>"<% if (elt.id) { %> id="<%= elt.id %>"<% } %>><%=tab_list%></ul><div class="tab-content" <% if (elt.id) { %> data-tabset="<%= elt.id %>"<% } %>><%=children%></div>',getElement:function(e){return t(e).parent().get(0)},onBeforeRender:function(t,n){var l=e.escapeHTML(n.id?n.id+"-":""),i="";return a.each(n.children,function(t,n){var a=e.escapeHTML(t.title||"Item "+(n+1)),d=a.replace(" ","_");i+='<li class="nav-item'+(0===n?" active":"")+'"><a href="#'+l+d+'" class="nav-link" data-tab="'+l+d+'" data-toggle="tab">'+a+"</a></li>"}),t.tab_list=i,t},onInsert:function(e,n){t("#"+n.id+">li.nav-item").on("click",function(e){e.preventDefault(),t(n.el).find("div[data-tabset='"+n.id+"']>div.tab-pane.active").each(function(){t(this).removeClass("active")});var a=t(this).find("a").attr("data-tab");t("#"+a).addClass("active")})}},tab:{template:'<div class="tab-pane<% if (elt.htmlClass) { %> <%= elt.htmlClass %> <% } %><% if (node.childPos === 0) { %> active<% } %>"<% if (node.title) { %> id="<%= node.parentNode.id %>-<%= node.title.replace(" ","_") %>"<% } %>><%= children %></div>'},selectfieldset:{template:'<fieldset class="tab-container <%= elt.htmlClass?elt.htmlClass:"" %>"><% if (node.legend) { %><legend role="treeitem" aria-expanded="false"><%= node.legend %></legend><% } %><% if (node.formElement.key) { %><input type="hidden" id="<%= node.id %>" name="<%= node.name %>" value="<%= escape(value) %>" /><% } else { %><a id="<%= node.id %>"></a><% } %><div class="tabbable"><div class="form-group<%= node.formElement.hideMenu ? " hide" : "" %>"><% if (!elt.notitle) { %><label for="<%= node.id %>"><%= node.title ? node.title : node.name %></label><% } %><div class="controls"><%= tabs %></div></div><div class="tab-content"><%= children %></div></div></fieldset>',inputfield:!0,getElement:function(e){return t(e).parent().get(0)},childTemplate:function(e){return'<div data-idx="<%= node.childPos %>" class="tab-pane<% if (node.active) { %> active<% } %>">'+e+"</div>"},onBeforeRender:function(t,n){var l=null,i=[];n.schemaElement&&(i=n.schemaElement.enum||[]),l=n.options?e.map(n.options,function(t,l){var d=n.children[l];return d.childPos=l,t instanceof Object?((t=e.extend({node:d},t)).title=t.title||d.legend||d.title||"Option "+(d.childPos+1),t.value=a.isSet(t.value)?t.value:a.isSet(i[l])?i[l]:l,t):{title:t,value:a.isSet(i[d.childPos])?i[d.childPos]:d.childPos,node:d}}):e.map(n.children,function(e,t){return e.childPos=t,{title:e.legend||e.title||"Option "+(e.childPos+1),value:i[e.childPos]||e.childPos,node:e}}),a.each(l,function(e,t){e.node.active=!1});var d=null;t.value&&(d=e.find(l,function(e){return e.value===n.value})),d||(d=e.find(l,function(e){return e.node.hasNonDefaultValue()})),d||(d=l[0]),d.node.active=!0,t.value=d.value;n.formElement;var s='<select class="nav form-control"'+(n.disabled?" disabled":"")+">";return a.each(l,function(t,n){s+='<option data-idx="'+n+'" value="'+t.value+'"'+(t.node.active?' selected="selected" class="active"':"")+">"+e.escapeHTML(t.title)+"</option>"}),s+="</select>",t.tabs=s,t},onInsert:function(e,n){t(n.el).find("select.nav").first().on("change",function(e){var a=t(this).find("option:selected");t(n.el).find('input[type="hidden"]').first().val(a.attr("value"))})}},optionfieldset:{template:'<div<% if (node.id) { %> id="<%= node.id %>"<% } %>><%= children %></div>'},section:{template:'<div<% if (elt.htmlClass) { %> class="<%= elt.htmlClass %>"<% } %><% if (node.id) { %> id="<%= node.id %>"<% } %>><%= children %></div>'},questions:{template:'<div><input type="hidden" id="<%= node.id %>" name="<%= node.name %>" value="<%= escape(value) %>" /><%= children %></div>',fieldtemplate:!0,inputfield:!0,getElement:function(e){return t(e).parent().get(0)},onInsert:function(e,n){n.children&&0!==n.children.length&&(a.each(n.children,function(e){t(e.el).hide()}),t(n.children[0].el).show())}},question:{template:'<div id="<%= node.id %>"><% _.forEach(node.options, function(key, val) { %><label class="<%= (node.formElement.optionsType === "radiobuttons") ? "btn btn-default" : "" %><%= ((key instanceof Object && key.htmlClass) ? " " + key.htmlClass : "") %>"><input type="radio" <% if (node.formElement.optionsType === "radiobuttons") { %> style="position:absolute;left:-9999px;" <% } %>name="<%= node.id %>" value="<%= val %>"<%= (node.disabled? " disabled" : "")%>/><span><%= (key instanceof Object ? key.title : key) %></span></label> <% }); %></div>',fieldtemplate:!0,onInsert:function(n,a){var l="active",i=a.formElement||{};i.activeClass&&(l+=" "+i.activeClass),t(a.el).find('input[type="radio"]').on("change",function(n){var i=null,d=a.options[t(this).val()];a.parentNode&&a.parentNode.el&&(t(this).parent().parent().find("label").removeClass(l),t(this).parent().addClass(l),t(a.el).nextAll().hide(),t(a.el).nextAll().find('input[type="radio"]').prop("checked",!1),d.value&&t(a.parentNode.el).find('input[type="hidden"]').val(d.value),d.next&&(i=e.find(a.parentNode.children,function(e){return e.formElement&&e.formElement.qid===d.next}),t(i.el).show(),t(i.el).nextAll().hide(),t(i.el).nextAll().find('input[type="radio"]').prop("checked",!1)),d.href&&(d.target?window.open(d.href,d.target):window.location=d.href),d.submit&&setTimeout(function(){a.ownerTree.submit()},0))})}}},n.elementTypes});
//# sourceMappingURL=sourcemaps/element-types.js.map
